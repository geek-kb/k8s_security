"use strict";(globalThis.webpackChunkk_8_s_security=globalThis.webpackChunkk_8_s_security||[]).push([[6977],{7615(e,s,n){n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"best-practices/cluster-setup-and-hardening/configuration-validation/kube-scan","title":"kube-scan","description":"kube-scan is a Kubernetes risk assessment tool that calculates risk scores for workloads based on their security configurations and potential attack impact.","source":"@site/docs/best-practices/cluster-setup-and-hardening/configuration-validation/kube-scan.md","sourceDirName":"best-practices/cluster-setup-and-hardening/configuration-validation","slug":"/best-practices/cluster-setup-and-hardening/configuration-validation/kube-scan","permalink":"/kubernetes-security/best-practices/cluster-setup-and-hardening/configuration-validation/kube-scan","draft":false,"unlisted":false,"editUrl":"https://github.com/geek-kb/k8s_security/edit/main/docs/best-practices/cluster-setup-and-hardening/configuration-validation/kube-scan.md","tags":[{"inline":true,"label":"tool","permalink":"/kubernetes-security/tags/tool"},{"inline":true,"label":"configuration-validation","permalink":"/kubernetes-security/tags/configuration-validation"},{"inline":true,"label":"risk-assessment","permalink":"/kubernetes-security/tags/risk-assessment"},{"inline":true,"label":"CKS","permalink":"/kubernetes-security/tags/cks"}],"version":"current","lastUpdatedBy":"Itai Ganot","lastUpdatedAt":1771236448000,"sidebarPosition":9,"frontMatter":{"sidebar_position":9,"title":"kube-scan","description":"kube-scan is a Kubernetes risk assessment tool that calculates risk scores for workloads based on their security configurations and potential attack impact.","keywords":["kubernetes security tool","kube-scan","risk assessment","security score","kubernetes security","workload risk","vulnerability assessment","OCTARINE","CKS"],"tags":["tool","configuration-validation","risk-assessment","CKS"],"related":["/kubernetes-security/best-practices/cluster-setup-and-hardening/configuration-validation/kubescape/","/kubernetes-security/best-practices/cluster-setup-and-hardening/pod-security/pod-security-standards/","/kubernetes-security/attack-vectors/privileged-container-escape/"]},"sidebar":"default","previous":{"title":"cnspec","permalink":"/kubernetes-security/best-practices/cluster-setup-and-hardening/configuration-validation/cnspec"},"next":{"title":"kubectl-kubesec","permalink":"/kubernetes-security/best-practices/cluster-setup-and-hardening/configuration-validation/kubectl-kubesec"}}');var t=n(4848),r=n(8453);const c={sidebar_position:9,title:"kube-scan",description:"kube-scan is a Kubernetes risk assessment tool that calculates risk scores for workloads based on their security configurations and potential attack impact.",keywords:["kubernetes security tool","kube-scan","risk assessment","security score","kubernetes security","workload risk","vulnerability assessment","OCTARINE","CKS"],tags:["tool","configuration-validation","risk-assessment","CKS"],related:["/kubernetes-security/best-practices/cluster-setup-and-hardening/configuration-validation/kubescape/","/kubernetes-security/best-practices/cluster-setup-and-hardening/pod-security/pod-security-standards/","/kubernetes-security/attack-vectors/privileged-container-escape/"]},a="kube-scan",l={},d=[{value:"How It Works",id:"how-it-works",level:2},{value:"Installation",id:"installation",level:2},{value:"Deploy with kubectl",id:"deploy-with-kubectl",level:3},{value:"Deploy with Helm",id:"deploy-with-helm",level:3},{value:"Access the Dashboard",id:"access-the-dashboard",level:2},{value:"Port Forward",id:"port-forward",level:3},{value:"Expose via Ingress",id:"expose-via-ingress",level:3},{value:"Risk Score Components",id:"risk-score-components",level:2},{value:"Security Context Factors",id:"security-context-factors",level:3},{value:"Network Exposure Factors",id:"network-exposure-factors",level:3},{value:"Volume Factors",id:"volume-factors",level:3},{value:"CLI Usage",id:"cli-usage",level:2},{value:"Get Risk Report",id:"get-risk-report",level:3},{value:"Export as JSON",id:"export-as-json",level:3},{value:"Scan Specific Namespace",id:"scan-specific-namespace",level:3},{value:"Example Output",id:"example-output",level:2},{value:"Interpreting Risk Scores",id:"interpreting-risk-scores",level:2},{value:"Remediation Guidance",id:"remediation-guidance",level:2},{value:"Example: Privileged Container",id:"example-privileged-container",level:3},{value:"Example: Host Network Access",id:"example-host-network-access",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Limitations",id:"limitations",level:2},{value:"References",id:"references",level:2}];function o(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"kube-scan",children:"kube-scan"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"kube-scan"})," is a Kubernetes risk assessment tool developed by Octarine (now part of VMware). It calculates risk scores for workloads based on their security configurations, considering factors like container privileges, network exposure, and potential attack impact. The tool helps prioritize security remediation by quantifying risk."]}),"\n",(0,t.jsx)(s.p,{children:"kube-scan provides a web-based dashboard for visualizing cluster-wide risk and drilling down into individual workload issues."}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,t.jsx)(s.p,{children:"kube-scan evaluates Kubernetes workloads against multiple risk factors:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Container security context"})," (privileged, capabilities, seccomp, AppArmor)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Network exposure"})," (services, ingress, host networking)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Volume mounts"})," (hostPath, sensitive paths)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Resource permissions"})," (RBAC, service accounts)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Image security"})," (known vulnerabilities, image sources)"]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Each factor contributes to an overall risk score on a 0-10 scale."}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(s.h3,{id:"deploy-with-kubectl",children:"Deploy with kubectl"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/octarinesec/kube-scan/master/kube-scan.yaml\n"})}),"\n",(0,t.jsx)(s.h3,{id:"deploy-with-helm",children:"Deploy with Helm"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"helm repo add kube-scan https://octarinesec.github.io/kube-scan\nhelm install kube-scan kube-scan/kube-scan --namespace kube-scan --create-namespace\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"access-the-dashboard",children:"Access the Dashboard"}),"\n",(0,t.jsx)(s.h3,{id:"port-forward",children:"Port Forward"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"kubectl port-forward -n kube-scan svc/kube-scan-ui 8080:80\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Access the dashboard at ",(0,t.jsx)(s.code,{children:"http://localhost:8080"})]}),"\n",(0,t.jsx)(s.h3,{id:"expose-via-ingress",children:"Expose via Ingress"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-yaml",children:"apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: kube-scan-ui\n  namespace: kube-scan\nspec:\n  rules:\n    - host: kube-scan.example.com\n      http:\n        paths:\n          - path: /\n            pathType: Prefix\n            backend:\n              service:\n                name: kube-scan-ui\n                port:\n                  number: 80\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"risk-score-components",children:"Risk Score Components"}),"\n",(0,t.jsx)(s.h3,{id:"security-context-factors",children:"Security Context Factors"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Factor"}),(0,t.jsx)(s.th,{children:"Low Risk"}),(0,t.jsx)(s.th,{children:"High Risk"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Privileged mode"}),(0,t.jsx)(s.td,{children:"false"}),(0,t.jsx)(s.td,{children:"true"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Host network"}),(0,t.jsx)(s.td,{children:"false"}),(0,t.jsx)(s.td,{children:"true"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Host PID"}),(0,t.jsx)(s.td,{children:"false"}),(0,t.jsx)(s.td,{children:"true"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Root user"}),(0,t.jsx)(s.td,{children:"Non-root"}),(0,t.jsx)(s.td,{children:"Root (UID 0)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Read-only filesystem"}),(0,t.jsx)(s.td,{children:"true"}),(0,t.jsx)(s.td,{children:"false"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Capabilities"}),(0,t.jsx)(s.td,{children:"Dropped"}),(0,t.jsx)(s.td,{children:"Added dangerous caps"})]})]})]}),"\n",(0,t.jsx)(s.h3,{id:"network-exposure-factors",children:"Network Exposure Factors"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Factor"}),(0,t.jsx)(s.th,{children:"Low Risk"}),(0,t.jsx)(s.th,{children:"High Risk"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Service type"}),(0,t.jsx)(s.td,{children:"ClusterIP"}),(0,t.jsx)(s.td,{children:"LoadBalancer/NodePort"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Ingress"}),(0,t.jsx)(s.td,{children:"None"}),(0,t.jsx)(s.td,{children:"Exposed externally"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Network policies"}),(0,t.jsx)(s.td,{children:"Enforced"}),(0,t.jsx)(s.td,{children:"None"})]})]})]}),"\n",(0,t.jsx)(s.h3,{id:"volume-factors",children:"Volume Factors"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Factor"}),(0,t.jsx)(s.th,{children:"Low Risk"}),(0,t.jsx)(s.th,{children:"High Risk"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"HostPath"}),(0,t.jsx)(s.td,{children:"None"}),(0,t.jsx)(s.td,{children:"/ or sensitive paths"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Secrets"}),(0,t.jsx)(s.td,{children:"Mounted securely"}),(0,t.jsx)(s.td,{children:"Exposed in env vars"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Config"}),(0,t.jsx)(s.td,{children:"ConfigMaps"}),(0,t.jsx)(s.td,{children:"Sensitive data in config"})]})]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"cli-usage",children:"CLI Usage"}),"\n",(0,t.jsx)(s.h3,{id:"get-risk-report",children:"Get Risk Report"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"kubectl exec -n kube-scan deploy/kube-scan -- kube-scan report\n"})}),"\n",(0,t.jsx)(s.h3,{id:"export-as-json",children:"Export as JSON"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"kubectl exec -n kube-scan deploy/kube-scan -- kube-scan report --output json > risk-report.json\n"})}),"\n",(0,t.jsx)(s.h3,{id:"scan-specific-namespace",children:"Scan Specific Namespace"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"kubectl exec -n kube-scan deploy/kube-scan -- kube-scan scan --namespace production\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"example-output",children:"Example Output"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"NAMESPACE     NAME                      RISK    ISSUES\nproduction    frontend-deployment       7.2     privileged=true, hostNetwork=true\nproduction    backend-deployment        4.5     root user, no resource limits\nproduction    database-statefulset      3.1     hostPath mount\nstaging       test-pod                  8.9     privileged=true, hostPID=true, hostPath=/\nkube-system   kube-proxy                2.1     expected for system components\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"interpreting-risk-scores",children:"Interpreting Risk Scores"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Score"}),(0,t.jsx)(s.th,{children:"Risk Level"}),(0,t.jsx)(s.th,{children:"Action Required"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"0-2"}),(0,t.jsx)(s.td,{children:"Low"}),(0,t.jsx)(s.td,{children:"Acceptable for most workloads"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"2-4"}),(0,t.jsx)(s.td,{children:"Medium-Low"}),(0,t.jsx)(s.td,{children:"Review for production workloads"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"4-6"}),(0,t.jsx)(s.td,{children:"Medium"}),(0,t.jsx)(s.td,{children:"Investigate and plan remediation"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"6-8"}),(0,t.jsx)(s.td,{children:"High"}),(0,t.jsx)(s.td,{children:"Prioritize remediation"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"8-10"}),(0,t.jsx)(s.td,{children:"Critical"}),(0,t.jsx)(s.td,{children:"Immediate action required"})]})]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"remediation-guidance",children:"Remediation Guidance"}),"\n",(0,t.jsx)(s.p,{children:"kube-scan provides specific remediation steps for each finding:"}),"\n",(0,t.jsx)(s.h3,{id:"example-privileged-container",children:"Example: Privileged Container"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Finding:"})," Container runs in privileged mode (risk +3.0)"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Remediation:"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-yaml",children:"spec:\n  containers:\n    - name: my-container\n      securityContext:\n        privileged: false  # Remove privileged mode\n        capabilities:\n          drop:\n            - ALL\n          add:\n            - NET_BIND_SERVICE  # Add only required capabilities\n"})}),"\n",(0,t.jsx)(s.h3,{id:"example-host-network-access",children:"Example: Host Network Access"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Finding:"})," Pod uses host network namespace (risk +2.5)"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Remediation:"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-yaml",children:"spec:\n  hostNetwork: false  # Use pod network instead\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Baseline your cluster:"})," Run kube-scan initially to understand current risk posture."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Set risk thresholds:"})," Define acceptable risk scores for different environments."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Integrate into CI/CD:"})," Scan manifests before deployment and block high-risk workloads."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Regular monitoring:"})," Deploy kube-scan permanently to detect risk increases over time."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Prioritize remediation:"})," Focus on critical and high-risk findings first."]}),"\n"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"limitations",children:"Limitations"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Risk scores are estimates based on configuration analysis."}),"\n",(0,t.jsx)(s.li,{children:"Does not perform runtime behavior analysis."}),"\n",(0,t.jsx)(s.li,{children:"Vulnerability scanning requires additional integration."}),"\n",(0,t.jsx)(s.li,{children:"Some risk factors may be acceptable for certain workloads (e.g., system components)."}),"\n"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"references",children:"References"}),"\n",(0,t.jsx)(s.p,{children:"This article is based on information from the following official sources:"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"https://github.com/octarinesec/kube-scan",children:"kube-scan GitHub Repository"})," - GitHub"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"https://kubernetes.io/docs/concepts/security/pod-security-standards/",children:"Pod Security Standards"})," - Kubernetes Documentation"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",children:"Security Context"})," - Kubernetes Documentation"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},8453(e,s,n){n.d(s,{R:()=>c,x:()=>a});var i=n(6540);const t={},r=i.createContext(t);function c(e){const s=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(r.Provider,{value:s},e.children)}}}]);