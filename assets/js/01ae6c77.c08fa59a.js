"use strict";(globalThis.webpackChunkk_8_s_security=globalThis.webpackChunkk_8_s_security||[]).push([[4159],{5526(e,s,n){n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"best_practices/cluster_setup_and_hardening/configuration_validation/checkov","title":"Checkov","description":"Checkov is a static analysis security tool for Terraform, Kubernetes, Docker, and Helm infrastructure-as-code files.","source":"@site/docs/best_practices/cluster_setup_and_hardening/configuration_validation/checkov.md","sourceDirName":"best_practices/cluster_setup_and_hardening/configuration_validation","slug":"/best_practices/cluster_setup_and_hardening/configuration_validation/checkov","permalink":"/docs/best_practices/cluster_setup_and_hardening/configuration_validation/checkov","draft":false,"unlisted":false,"editUrl":"https://github.com/geek-kb/k8s_security/edit/main/docs/best_practices/cluster_setup_and_hardening/configuration_validation/checkov.md","tags":[],"version":"current","lastUpdatedBy":"Itai Ganot","lastUpdatedAt":1765581437000,"sidebarPosition":7,"frontMatter":{"title":"Checkov","description":"Checkov is a static analysis security tool for Terraform, Kubernetes, Docker, and Helm infrastructure-as-code files.","sidebar_position":7,"keywords":["kubernetes security tool","checkov","static analysis","infrastructure as code security","IaC scanning","policy as code","terraform security","helm security","CKS"]},"sidebar":"default","previous":{"title":"kube-linter","permalink":"/docs/best_practices/cluster_setup_and_hardening/configuration_validation/kube_linter"},"next":{"title":"System Hardening","permalink":"/docs/best_practices/system_hardening/intro"}}');var c=n(4848),i=n(8453);const t={title:"Checkov",description:"Checkov is a static analysis security tool for Terraform, Kubernetes, Docker, and Helm infrastructure-as-code files.",sidebar_position:7,keywords:["kubernetes security tool","checkov","static analysis","infrastructure as code security","IaC scanning","policy as code","terraform security","helm security","CKS"]},a="Checkov",o={},l=[{value:"Usage",id:"usage",level:2},{value:"1. Install Checkov",id:"1-install-checkov",level:3},{value:"2. Scan Kubernetes Manifests",id:"2-scan-kubernetes-manifests",level:3},{value:"3. Scan Helm Charts",id:"3-scan-helm-charts",level:3},{value:"4. Scan Terraform, Dockerfiles, and More",id:"4-scan-terraform-dockerfiles-and-more",level:3},{value:"5. Use Checkov with CI/CD",id:"5-use-checkov-with-cicd",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Resources",id:"resources",level:2}];function d(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.header,{children:(0,c.jsx)(s.h1,{id:"checkov",children:"Checkov"})}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Checkov"})," is an open-source static analysis tool that scans ",(0,c.jsx)(s.strong,{children:"Infrastructure-as-Code (IaC)"})," files such as ",(0,c.jsx)(s.strong,{children:"Kubernetes manifests, Terraform, Helm charts, and Dockerfiles"})," for ",(0,c.jsx)(s.strong,{children:"security misconfigurations and compliance violations"}),". It helps identify potential security risks before deployment."]}),"\n",(0,c.jsxs)(s.p,{children:["Checkov is widely used to enforce ",(0,c.jsx)(s.strong,{children:"policy-as-code"})," and supports integration into development workflows and CI/CD pipelines."]}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h2,{id:"usage",children:"Usage"}),"\n",(0,c.jsx)(s.h3,{id:"1-install-checkov",children:"1. Install Checkov"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:"pip install checkov\n"})}),"\n",(0,c.jsx)(s.p,{children:"Or use Docker:"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:"docker run -t bridgecrew/checkov\n"})}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"2-scan-kubernetes-manifests",children:"2. Scan Kubernetes Manifests"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:"checkov -f deployment.yaml\n"})}),"\n",(0,c.jsx)(s.p,{children:"This scans a single Kubernetes manifest file for common misconfigurations."}),"\n",(0,c.jsx)(s.p,{children:"You can also scan directories:"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:"checkov -d ./k8s-manifests/\n"})}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"3-scan-helm-charts",children:"3. Scan Helm Charts"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:"checkov -d ./my-helm-chart/\n"})}),"\n",(0,c.jsx)(s.p,{children:"Checkov renders the templates and scans the resulting Kubernetes manifests."}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"4-scan-terraform-dockerfiles-and-more",children:"4. Scan Terraform, Dockerfiles, and More"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:"checkov -d ./terraform\ncheckov -f Dockerfile\n"})}),"\n",(0,c.jsx)(s.p,{children:"This enables consistent security policies across multiple layers of infrastructure."}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"5-use-checkov-with-cicd",children:"5. Use Checkov with CI/CD"}),"\n",(0,c.jsx)(s.p,{children:"Example GitHub Action:"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-yaml",children:"- name: Run Checkov\n  uses: bridgecrewio/checkov-action@master\n  with:\n    directory: ./k8s\n    framework: kubernetes\n"})}),"\n",(0,c.jsx)(s.p,{children:"Checkov also integrates with Jenkins, GitLab, CircleCI, and more."}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:["Integrate Checkov scans into ",(0,c.jsx)(s.strong,{children:"CI/CD pipelines"})," to block insecure configurations during pull requests."]}),"\n",(0,c.jsxs)(s.li,{children:["Scan ",(0,c.jsx)(s.strong,{children:"Helm charts before deployment"}),", not just raw manifests."]}),"\n",(0,c.jsxs)(s.li,{children:["Use Checkov\u2019s ",(0,c.jsx)(s.strong,{children:"baseline suppression file"})," to ignore known, accepted issues."]}),"\n",(0,c.jsxs)(s.li,{children:["Combine Checkov with tools like ",(0,c.jsx)(s.code,{children:"kubescape"})," or ",(0,c.jsx)(s.code,{children:"conftest"})," for layered validation."]}),"\n",(0,c.jsx)(s.li,{children:"Regularly update the tool to benefit from new policies and community-maintained rules."}),"\n"]}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h2,{id:"resources",children:"Resources"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.strong,{children:"GitHub:"})," ",(0,c.jsx)(s.a,{href:"https://github.com/bridgecrewio/checkov",children:"https://github.com/bridgecrewio/checkov"})]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.strong,{children:"Official Documentation:"})," ",(0,c.jsx)(s.a,{href:"https://www.checkov.io/",children:"https://www.checkov.io/"})]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,c.jsx)(s,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},8453(e,s,n){n.d(s,{R:()=>t,x:()=>a});var r=n(6540);const c={},i=r.createContext(c);function t(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:t(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);