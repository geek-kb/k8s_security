"use strict";(globalThis.webpackChunkk_8_s_security=globalThis.webpackChunkk_8_s_security||[]).push([[2995],{5825(e,s,n){n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"best_practices/cluster_setup_and_hardening/secrets_management/imagepullsecrets_security","title":"Securing ImagePullSecrets","description":"Best practices for protecting container registry credentials and preventing ImagePullSecrets theft in Kubernetes.","source":"@site/docs/best_practices/cluster_setup_and_hardening/secrets_management/imagepullsecrets_security.md","sourceDirName":"best_practices/cluster_setup_and_hardening/secrets_management","slug":"/best_practices/cluster_setup_and_hardening/secrets_management/imagepullsecrets_security","permalink":"/docs/best_practices/cluster_setup_and_hardening/secrets_management/imagepullsecrets_security","draft":false,"unlisted":false,"editUrl":"https://github.com/geek-kb/k8s_security/edit/main/docs/best_practices/cluster_setup_and_hardening/secrets_management/imagepullsecrets_security.md","tags":[],"version":"current","lastUpdatedBy":"Itai Ganot","lastUpdatedAt":1765579678000,"sidebarPosition":10,"frontMatter":{"title":"Securing ImagePullSecrets","sidebar_position":10,"description":"Best practices for protecting container registry credentials and preventing ImagePullSecrets theft in Kubernetes.","keywords":["kubernetes security best practices","imagepullsecrets security","container registry security","secrets management","docker credentials","registry authentication","IRSA","workload identity","external secrets operator","secrets rotation"]},"sidebar":"default","previous":{"title":"Mozilla SOPS","permalink":"/docs/best_practices/cluster_setup_and_hardening/secrets_management/mozilla_sops"},"next":{"title":"Configuration Validation","permalink":"/docs/category/configuration-validation"}}');var r=n(4848),i=n(8453);const a={title:"Securing ImagePullSecrets",sidebar_position:10,description:"Best practices for protecting container registry credentials and preventing ImagePullSecrets theft in Kubernetes.",keywords:["kubernetes security best practices","imagepullsecrets security","container registry security","secrets management","docker credentials","registry authentication","IRSA","workload identity","external secrets operator","secrets rotation"]},c="Securing ImagePullSecrets",l={},o=[{value:"1. Restrict RBAC Access to Secrets",id:"1-restrict-rbac-access-to-secrets",level:2},{value:"Deny Direct Secret Access",id:"deny-direct-secret-access",level:3},{value:"Create Service Account Without Secret Mounting",id:"create-service-account-without-secret-mounting",level:3},{value:"Audit Secret Access",id:"audit-secret-access",level:3},{value:"2. Use Encrypted Secrets at Rest",id:"2-use-encrypted-secrets-at-rest",level:2},{value:"Enable etcd Encryption",id:"enable-etcd-encryption",level:3},{value:"3. Use Short-Lived Registry Tokens",id:"3-use-short-lived-registry-tokens",level:2},{value:"AWS ECR with IAM Roles (IRSA)",id:"aws-ecr-with-iam-roles-irsa",level:3},{value:"Azure AKR with Managed Identity",id:"azure-akr-with-managed-identity",level:3},{value:"GCR with Workload Identity",id:"gcr-with-workload-identity",level:3},{value:"4. Implement Secret Rotation",id:"4-implement-secret-rotation",level:2},{value:"External Secrets Operator with HashiCorp Vault",id:"external-secrets-operator-with-hashicorp-vault",level:3},{value:"5. Use Pod Security Standards",id:"5-use-pod-security-standards",level:2},{value:"Apply Restricted Pod Security",id:"apply-restricted-pod-security",level:3},{value:"Use AdmissionPolicy to Restrict Secret Mounts",id:"use-admissionpolicy-to-restrict-secret-mounts",level:3},{value:"6. Implement Registry Access Controls",id:"6-implement-registry-access-controls",level:2},{value:"Enable Registry IP Allowlisting",id:"enable-registry-ip-allowlisting",level:3},{value:"Enable Registry Audit Logging",id:"enable-registry-audit-logging",level:3},{value:"Use Registry Image Scanning",id:"use-registry-image-scanning",level:3},{value:"7. Monitor and Audit Secret Access",id:"7-monitor-and-audit-secret-access",level:2},{value:"Enable Audit Logging for Secrets",id:"enable-audit-logging-for-secrets",level:3},{value:"Create Alerts for Secret Access",id:"create-alerts-for-secret-access",level:3},{value:"Query Secret Access Logs",id:"query-secret-access-logs",level:3},{value:"8. Use Image Pull Through Cache",id:"8-use-image-pull-through-cache",level:2},{value:"Deploy Registry Mirror",id:"deploy-registry-mirror",level:3},{value:"Security Checklist",id:"security-checklist",level:2},{value:"Links",id:"links",level:2}];function d(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"securing-imagepullsecrets",children:"Securing ImagePullSecrets"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Required knowledge for the CKS certification."})}),"\n",(0,r.jsxs)(s.p,{children:["Container registry credentials stored as ",(0,r.jsx)(s.strong,{children:"ImagePullSecrets"})," are high-value targets for attackers. If compromised, these credentials enable unauthorized access to private registries, intellectual property theft, and supply chain attacks through malicious image injection."]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Issue:"})," ImagePullSecrets are stored as base64-encoded plaintext in Kubernetes secrets, making them vulnerable to extraction by anyone with secret read access.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.strong,{children:"Fix:"})," Implement defense-in-depth strategies including RBAC restrictions, secret encryption, short-lived credentials, and registry security controls."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"1-restrict-rbac-access-to-secrets",children:"1. Restrict RBAC Access to Secrets"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Issue:"})," Overly permissive RBAC roles grant unnecessary access to secrets containing registry credentials.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.strong,{children:"Fix:"})," Apply the principle of least privilege and deny direct secret access where possible."]}),"\n",(0,r.jsx)(s.h3,{id:"deny-direct-secret-access",children:"Deny Direct Secret Access"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:'apiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: app-deployer\n  namespace: production\nrules:\n  - apiGroups: [""]\n    resources: ["pods", "services", "configmaps"]\n    verbs: ["get", "list", "create", "update", "delete"]\n  - apiGroups: ["apps"]\n    resources: ["deployments", "statefulsets"]\n    verbs: ["get", "list", "create", "update", "delete"]\n  # Explicitly deny secrets access\n  # Do not include secrets in the rules\n'})}),"\n",(0,r.jsx)(s.h3,{id:"create-service-account-without-secret-mounting",children:"Create Service Account Without Secret Mounting"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: limited-sa\n  namespace: production\nautomountServiceAccountToken: false\n"})}),"\n",(0,r.jsx)(s.h3,{id:"audit-secret-access",children:"Audit Secret Access"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Check who has secrets access in a namespace\nkubectl auth can-i get secrets --as system:serviceaccount:production:default -n production\n\n# List all roles with secret access\nkubectl get roles,clusterroles -A -o json | \\\n  jq '.items[] | select(.rules[]? | select(.resources[]? == \"secrets\"))'\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"2-use-encrypted-secrets-at-rest",children:"2. Use Encrypted Secrets at Rest"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Issue:"})," Secrets are stored unencrypted in etcd by default, allowing anyone with etcd access to read registry credentials.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.strong,{children:"Fix:"})," Enable encryption at rest for Kubernetes secrets."]}),"\n",(0,r.jsx)(s.h3,{id:"enable-etcd-encryption",children:"Enable etcd Encryption"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"apiVersion: apiserver.config.k8s.io/v1\nkind: EncryptionConfiguration\nresources:\n  - resources:\n      - secrets\n    providers:\n      - aescbc:\n          keys:\n            - name: key1\n              secret: $(head -c 32 /dev/urandom | base64)\n      - identity: {}\n"})}),"\n",(0,r.jsx)(s.p,{children:"Apply the encryption configuration:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Configure kube-apiserver with encryption config\nkube-apiserver \\\n  --encryption-provider-config=/etc/kubernetes/encryption-config.yaml\n"})}),"\n",(0,r.jsx)(s.p,{children:"Verify encryption:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Check if a secret is encrypted in etcd\nETCDCTL_API=3 etcdctl get /registry/secrets/production/registry-credentials \\\n  --endpoints=https://127.0.0.1:2379 \\\n  --cacert=/etc/kubernetes/pki/etcd/ca.crt \\\n  --cert=/etc/kubernetes/pki/etcd/server.crt \\\n  --key=/etc/kubernetes/pki/etcd/server.key\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"3-use-short-lived-registry-tokens",children:"3. Use Short-Lived Registry Tokens"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Issue:"})," Long-lived static credentials in ImagePullSecrets remain valid indefinitely if compromised.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.strong,{children:"Fix:"})," Implement token rotation and use registry-native short-lived access tokens."]}),"\n",(0,r.jsx)(s.h3,{id:"aws-ecr-with-iam-roles-irsa",children:"AWS ECR with IAM Roles (IRSA)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: ecr-pull-sa\n  namespace: production\n  annotations:\n    eks.amazonaws.com/role-arn: arn:aws:iam::123456789012:role/ECRPullRole\n---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: app-pod\n  namespace: production\nspec:\n  serviceAccountName: ecr-pull-sa\n  containers:\n    - name: app\n      image: 123456789012.dkr.ecr.us-west-2.amazonaws.com/myapp:latest\n"})}),"\n",(0,r.jsx)(s.p,{children:"The pod uses IAM roles to obtain temporary ECR credentials automatically."}),"\n",(0,r.jsx)(s.h3,{id:"azure-akr-with-managed-identity",children:"Azure AKR with Managed Identity"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Pod\nmetadata:\n  name: app-pod\n  namespace: production\nspec:\n  containers:\n    - name: app\n      image: myregistry.azurecr.io/myapp:latest\n  nodeSelector:\n    kubernetes.io/os: linux\n"})}),"\n",(0,r.jsx)(s.p,{children:"Configure AKS cluster with managed identity for ACR access:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"az aks update -n myAKSCluster -g myResourceGroup --attach-acr myregistry\n"})}),"\n",(0,r.jsx)(s.h3,{id:"gcr-with-workload-identity",children:"GCR with Workload Identity"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: gcr-pull-sa\n  namespace: production\n  annotations:\n    iam.gke.io/gcp-service-account: gcr-puller@project.iam.gserviceaccount.com\n---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: app-pod\n  namespace: production\nspec:\n  serviceAccountName: gcr-pull-sa\n  containers:\n    - name: app\n      image: gcr.io/project/myapp:latest\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"4-implement-secret-rotation",children:"4. Implement Secret Rotation"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Issue:"})," Static registry credentials are never rotated, increasing risk if compromised.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.strong,{children:"Fix:"})," Automate secret rotation using external secret management tools."]}),"\n",(0,r.jsx)(s.h3,{id:"external-secrets-operator-with-hashicorp-vault",children:"External Secrets Operator with HashiCorp Vault"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:'apiVersion: external-secrets.io/v1beta1\nkind: SecretStore\nmetadata:\n  name: vault-backend\n  namespace: production\nspec:\n  provider:\n    vault:\n      server: "https://vault.company.com"\n      path: "secret"\n      version: "v2"\n      auth:\n        kubernetes:\n          mountPath: "kubernetes"\n          role: "production-role"\n---\napiVersion: external-secrets.io/v1beta1\nkind: ExternalSecret\nmetadata:\n  name: registry-credentials\n  namespace: production\nspec:\n  refreshInterval: 1h\n  secretStoreRef:\n    name: vault-backend\n    kind: SecretStore\n  target:\n    name: registry-credentials\n    creationPolicy: Owner\n    template:\n      type: kubernetes.io/dockerconfigjson\n  data:\n    - secretKey: .dockerconfigjson\n      remoteRef:\n        key: registry/credentials\n        property: dockerconfig\n'})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"5-use-pod-security-standards",children:"5. Use Pod Security Standards"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Issue:"})," Pods can mount any secrets in their namespace, including ImagePullSecrets.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.strong,{children:"Fix:"})," Apply Pod Security Standards to restrict secret access at the pod level."]}),"\n",(0,r.jsx)(s.h3,{id:"apply-restricted-pod-security",children:"Apply Restricted Pod Security"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Namespace\nmetadata:\n  name: production\n  labels:\n    pod-security.kubernetes.io/enforce: restricted\n    pod-security.kubernetes.io/audit: restricted\n    pod-security.kubernetes.io/warn: restricted\n"})}),"\n",(0,r.jsx)(s.h3,{id:"use-admissionpolicy-to-restrict-secret-mounts",children:"Use AdmissionPolicy to Restrict Secret Mounts"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:'apiVersion: admissionregistration.k8s.io/v1\nkind: ValidatingAdmissionPolicy\nmetadata:\n  name: restrict-secret-mounts\nspec:\n  failurePolicy: Fail\n  matchConstraints:\n    resourceRules:\n      - apiGroups: [""]\n        apiVersions: ["v1"]\n        operations: ["CREATE", "UPDATE"]\n        resources: ["pods"]\n  validations:\n    - expression: "!object.spec.volumes.exists(v, v.secret != null && v.secret.secretName.startsWith(\'registry-\'))"\n      message: "Direct mounting of registry secrets is not allowed"\n'})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"6-implement-registry-access-controls",children:"6. Implement Registry Access Controls"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Issue:"})," Stolen credentials provide full registry access without additional controls.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.strong,{children:"Fix:"})," Enable registry-side security features to limit credential misuse."]}),"\n",(0,r.jsx)(s.h3,{id:"enable-registry-ip-allowlisting",children:"Enable Registry IP Allowlisting"}),"\n",(0,r.jsx)(s.p,{children:"For Docker Registry:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"version: 0.1\nhttp:\n  addr: :5000\n  secret: randomsecret\n  headers:\n    X-Content-Type-Options: [nosniff]\nmiddleware:\n  registry:\n    - name: cloudfront\n      options:\n        privatekey: /path/to/pk.pem\n        keypairid: APKAXXXXXXXXXXXXXXXX\n        baseurl: https://registry.company.com\n  storage:\n    - name: s3\n      options:\n        accesskey: AKIAIOSFODNN7EXAMPLE\n        secretkey: wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n        region: us-west-2\n        bucket: my-registry\n        allowedips:\n          - 10.0.0.0/8\n          - 172.16.0.0/12\n"})}),"\n",(0,r.jsx)(s.h3,{id:"enable-registry-audit-logging",children:"Enable Registry Audit Logging"}),"\n",(0,r.jsx)(s.p,{children:"For Harbor Registry:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: harbor-config\n  namespace: harbor\ndata:\n  config.yaml: |\n    harbor:\n      admin_password: Harbor12345\n      database:\n        password: changeit\n      jobservice:\n        secret: changeit\n      registry:\n        secret: changeit\n    audit:\n      enabled: true\n      log_level: info\n      rotation:\n        max_size: 100\n        max_age: 30\n"})}),"\n",(0,r.jsx)(s.h3,{id:"use-registry-image-scanning",children:"Use Registry Image Scanning"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'# Enable vulnerability scanning in Harbor\ncurl -X PUT "https://harbor.company.com/api/v2.0/projects/production" \\\n  -H "Authorization: Basic $(echo -n admin:Harbor12345 | base64)" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "metadata": {\n      "auto_scan": "true",\n      "prevent_vul": "true",\n      "severity": "high"\n    }\n  }\'\n'})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"7-monitor-and-audit-secret-access",children:"7. Monitor and Audit Secret Access"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Issue:"})," Secret theft goes undetected without proper monitoring and alerting.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.strong,{children:"Fix:"})," Implement comprehensive audit logging and alerting for secret access."]}),"\n",(0,r.jsx)(s.h3,{id:"enable-audit-logging-for-secrets",children:"Enable Audit Logging for Secrets"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:'apiVersion: audit.k8s.io/v1\nkind: Policy\nrules:\n  - level: RequestResponse\n    verbs: ["get", "list", "watch"]\n    resources:\n      - group: ""\n        resources: ["secrets"]\n    omitStages:\n      - RequestReceived\n  - level: Metadata\n    resources:\n      - group: ""\n        resources: ["secrets"]\n    verbs: ["create", "update", "patch", "delete"]\n'})}),"\n",(0,r.jsx)(s.h3,{id:"create-alerts-for-secret-access",children:"Create Alerts for Secret Access"}),"\n",(0,r.jsx)(s.p,{children:"Using Falco:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:'- rule: Registry Secret Access\n  desc: Detect access to ImagePullSecrets\n  condition: >\n    kevt and ka.verb in (get,list,watch) and\n    ka.target.resource = "secrets" and\n    ka.target.name contains "registry"\n  output: >\n    Registry secret accessed (user=%ka.user.name\n    secret=%ka.target.name ns=%ka.target.namespace)\n  priority: WARNING\n  tags: [k8s, secrets, registry]\n'})}),"\n",(0,r.jsx)(s.h3,{id:"query-secret-access-logs",children:"Query Secret Access Logs"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'# Search audit logs for secret access\nkubectl logs -n kube-system kube-apiserver-master -f | \\\n  grep -E "secrets.*registry.*GET|LIST"\n\n# Check who accessed secrets recently\nkubectl get events -A --field-selector reason=SecretAccessed\n'})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"8-use-image-pull-through-cache",children:"8. Use Image Pull Through Cache"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Issue:"})," Every pod pull requires registry credentials, increasing exposure of ImagePullSecrets.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.strong,{children:"Fix:"})," Use registry pull-through cache to minimize credential usage."]}),"\n",(0,r.jsx)(s.h3,{id:"deploy-registry-mirror",children:"Deploy Registry Mirror"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: registry-mirror\n  namespace: kube-system\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: registry-mirror\n  template:\n    metadata:\n      labels:\n        app: registry-mirror\n    spec:\n      containers:\n        - name: registry\n          image: registry:2\n          env:\n            - name: REGISTRY_PROXY_REMOTEURL\n              value: https://registry.company.com\n            - name: REGISTRY_PROXY_USERNAME\n              valueFrom:\n                secretKeyRef:\n                  name: registry-proxy-secret\n                  key: username\n            - name: REGISTRY_PROXY_PASSWORD\n              valueFrom:\n                secretKeyRef:\n                  name: registry-proxy-secret\n                  key: password\n          volumeMounts:\n            - name: cache\n              mountPath: /var/lib/registry\n      volumes:\n        - name: cache\n          emptyDir: {}\n"})}),"\n",(0,r.jsx)(s.p,{children:"Configure containerd to use mirror:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-toml",children:'[plugins."io.containerd.grpc.v1.cri".registry.mirrors]\n  [plugins."io.containerd.grpc.v1.cri".registry.mirrors."registry.company.com"]\n    endpoint = ["http://registry-mirror.kube-system.svc.cluster.local:5000"]\n'})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"security-checklist",children:"Security Checklist"}),"\n",(0,r.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Restrict RBAC access to secrets using principle of least privilege"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Enable encryption at rest for Kubernetes secrets in etcd"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Use cloud-native authentication (IRSA, Workload Identity, Managed Identity)"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Implement automatic secret rotation with External Secrets Operator"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Apply Pod Security Standards to restrict secret mounting"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Enable registry IP allowlisting and network controls"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Configure registry vulnerability scanning and prevention"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Enable comprehensive audit logging for secret access"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Set up alerts for suspicious secret access patterns"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Use registry pull-through cache to minimize credential exposure"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Regularly rotate registry credentials"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Implement registry access reviews and credential lifecycle management"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"links",children:"Links"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://kubernetes.io/docs/concepts/configuration/secret/",children:"Kubernetes Secrets Documentation"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/",children:"Encrypting Secret Data at Rest"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://external-secrets.io/",children:"External Secrets Operator"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/docs/best_practices/cluster_setup_and_hardening/pod_security/pod_security_standards",children:"Pod Security Standards"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/docs/best_practices/cluster_setup_and_hardening/rbac_and_identity/insecure_rbac_permissions_mitigation",children:"RBAC Security"})}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,s,n){n.d(s,{R:()=>a,x:()=>c});var t=n(6540);const r={},i=t.createContext(r);function a(e){const s=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);