"use strict";(self.webpackChunkk_8_s_security=self.webpackChunkk_8_s_security||[]).push([[8167],{2891:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"cluster_setup_and_hardening/k8s_security_primitives/certificates","title":"Certificates in Kubernetes","description":"\ud83d\udd10 What Are Certificates in Kubernetes?","source":"@site/docs/cluster_setup_and_hardening/k8s_security_primitives/certificates.md","sourceDirName":"cluster_setup_and_hardening/k8s_security_primitives","slug":"/cluster_setup_and_hardening/k8s_security_primitives/certificates","permalink":"/k8s_security/docs/cluster_setup_and_hardening/k8s_security_primitives/certificates","draft":false,"unlisted":false,"editUrl":"https://github.com/geek-kb/k8s_security/edit/main/docs/cluster_setup_and_hardening/k8s_security_primitives/certificates.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Certificates in Kubernetes","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Webhook Authorization in Kubernetes","permalink":"/k8s_security/docs/cluster_setup_and_hardening/k8s_security_primitives/authorization/webhook_authorization"},"next":{"title":"Service Accounts in Kubernetes","permalink":"/k8s_security/docs/cluster_setup_and_hardening/k8s_security_primitives/service_accounts"}}');var t=s(4848),i=s(8453);const c={title:"Certificates in Kubernetes",sidebar_position:3},a="Certificates in Kubernetes",l={},o=[{value:"\ud83d\udd10 <strong>What Are Certificates in Kubernetes?</strong>",id:"-what-are-certificates-in-kubernetes",level:2},{value:"\ud83d\udee0\ufe0f <strong>Common Use Cases for Certificates in Kubernetes:</strong>",id:"\ufe0f-common-use-cases-for-certificates-in-kubernetes",level:2},{value:"\ud83d\udcd1 <strong>Types of Certificates in Kubernetes:</strong>",id:"-types-of-certificates-in-kubernetes",level:2},{value:"1. <strong>Client Certificates:</strong>",id:"1-client-certificates",level:3},{value:"2. <strong>Server Certificates:</strong>",id:"2-server-certificates",level:3},{value:"3. <strong>TLS Certificates for Ingress Controllers:</strong>",id:"3-tls-certificates-for-ingress-controllers",level:3},{value:"4. <strong>Service Account Tokens vs. Certificates:</strong>",id:"4-service-account-tokens-vs-certificates",level:3},{value:"\ud83d\udd04 <strong>Automating Certificate Management with Cert-Manager:</strong>",id:"-automating-certificate-management-with-cert-manager",level:2},{value:"\ud83d\udea6 <strong>Installation:</strong>",id:"-installation",level:3},{value:"\u2705 <strong>Create a Self-Signed Issuer:</strong>",id:"-create-a-self-signed-issuer",level:3},{value:"\ud83d\udd11 <strong>Requesting a Certificate:</strong>",id:"-requesting-a-certificate",level:3},{value:"\u2705 <strong>Best Practices for Managing Certificates:</strong>",id:"-best-practices-for-managing-certificates",level:2},{value:"\ud83d\udd10 <strong>Conclusion: Certificates Enhance Cluster Security</strong>",id:"-conclusion-certificates-enhance-cluster-security",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"certificates-in-kubernetes",children:"Certificates in Kubernetes"})}),"\n",(0,t.jsxs)(n.h2,{id:"-what-are-certificates-in-kubernetes",children:["\ud83d\udd10 ",(0,t.jsx)(n.strong,{children:"What Are Certificates in Kubernetes?"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Certificates"})," in Kubernetes are ",(0,t.jsx)(n.strong,{children:"digital certificates"})," used to secure ",(0,t.jsx)(n.strong,{children:"communications"})," between ",(0,t.jsx)(n.strong,{children:"components"}),", enable ",(0,t.jsx)(n.strong,{children:"TLS encryption"}),", and facilitate ",(0,t.jsx)(n.strong,{children:"authentication"}),". Certificates ensure the ",(0,t.jsx)(n.strong,{children:"confidentiality"}),", ",(0,t.jsx)(n.strong,{children:"integrity"}),", and ",(0,t.jsx)(n.strong,{children:"authentication"})," of data ",(0,t.jsx)(n.strong,{children:"in transit"})," within the Kubernetes cluster."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"\ufe0f-common-use-cases-for-certificates-in-kubernetes",children:["\ud83d\udee0\ufe0f ",(0,t.jsx)(n.strong,{children:"Common Use Cases for Certificates in Kubernetes:"})]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Securing Kubernetes API Server Communication:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"mTLS (Mutual TLS)"})," between ",(0,t.jsx)(n.strong,{children:"API server"})," and ",(0,t.jsx)(n.strong,{children:"Kubelets"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Intra-Cluster Communication:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Enable ",(0,t.jsx)(n.strong,{children:"mTLS"})," between ",(0,t.jsx)(n.strong,{children:"pods"})," and ",(0,t.jsx)(n.strong,{children:"services"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Ingress TLS/SSL Certificates:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Secure ",(0,t.jsx)(n.strong,{children:"external access"})," through ",(0,t.jsx)(n.strong,{children:"Ingress Controllers"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Authentication:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Generate ",(0,t.jsx)(n.strong,{children:"X.509 certificates"})," for ",(0,t.jsx)(n.strong,{children:"user authentication"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"-types-of-certificates-in-kubernetes",children:["\ud83d\udcd1 ",(0,t.jsx)(n.strong,{children:"Types of Certificates in Kubernetes:"})]}),"\n",(0,t.jsxs)(n.h3,{id:"1-client-certificates",children:["1. ",(0,t.jsx)(n.strong,{children:"Client Certificates:"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Used for ",(0,t.jsx)(n.strong,{children:"client authentication"})," with the ",(0,t.jsx)(n.strong,{children:"Kubernetes API server"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Required for ",(0,t.jsx)(n.strong,{children:"kubectl"})," or ",(0,t.jsx)(n.strong,{children:"API access"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Generate a Client Certificate\nopenssl req -new -newkey rsa:2048 -nodes -keyout user.key -out user.csr -subj "/CN=example-user"\n\n# Sign the Certificate with Kubernetes CA\nopenssl x509 -req -in user.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out user.crt -days 365\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h3,{id:"2-server-certificates",children:["2. ",(0,t.jsx)(n.strong,{children:"Server Certificates:"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Secures ",(0,t.jsx)(n.strong,{children:"server endpoints"})," with ",(0,t.jsx)(n.strong,{children:"TLS encryption"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Commonly used for the ",(0,t.jsx)(n.strong,{children:"API server"}),", ",(0,t.jsx)(n.strong,{children:"Kubelets"}),", and ",(0,t.jsx)(n.strong,{children:"webhooks"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Create a server certificate for the API server\nopenssl req -new -key apiserver.key -out apiserver.csr -subj "/CN=kube-apiserver"\n\n# Sign with the Kubernetes Certificate Authority (CA)\nopenssl x509 -req -in apiserver.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out apiserver.crt -days 365\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h3,{id:"3-tls-certificates-for-ingress-controllers",children:["3. ",(0,t.jsx)(n.strong,{children:"TLS Certificates for Ingress Controllers:"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Used to secure ",(0,t.jsx)(n.strong,{children:"Ingress traffic"})," using ",(0,t.jsx)(n.strong,{children:"HTTPS"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Automate with ",(0,t.jsx)(n.strong,{children:"Cert-Manager"})," and ",(0,t.jsx)(n.strong,{children:"Let's Encrypt"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"# Example: Issuing a TLS Certificate with Cert-Manager\napiVersion: cert-manager.io/v1\nkind: Certificate\nmetadata:\n  name: example-cert\n  namespace: default\nspec:\n  secretName: example-cert-tls\n  issuerRef:\n    name: letsencrypt-issuer\n    kind: ClusterIssuer\n  dnsNames:\n    - example.com\n    - www.example.com\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h3,{id:"4-service-account-tokens-vs-certificates",children:["4. ",(0,t.jsx)(n.strong,{children:"Service Account Tokens vs. Certificates:"})]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Feature"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Service Account Token"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Certificate"})})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Use Case"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Pod authentication"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"User and server authentication"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Renewal"})}),(0,t.jsx)(n.td,{children:"Automatic"}),(0,t.jsxs)(n.td,{children:["Requires ",(0,t.jsx)(n.strong,{children:"manual"})," or ",(0,t.jsx)(n.strong,{children:"automated rotation"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Security"})}),(0,t.jsxs)(n.td,{children:["Token-based ",(0,t.jsx)(n.strong,{children:"JWT"})]}),(0,t.jsxs)(n.td,{children:["Encrypted ",(0,t.jsx)(n.strong,{children:"X.509 certificates"})]})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"-automating-certificate-management-with-cert-manager",children:["\ud83d\udd04 ",(0,t.jsx)(n.strong,{children:"Automating Certificate Management with Cert-Manager:"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Cert-Manager"})," is a ",(0,t.jsx)(n.strong,{children:"Kubernetes add-on"})," that automates the ",(0,t.jsx)(n.strong,{children:"creation"}),", ",(0,t.jsx)(n.strong,{children:"renewal"}),", and ",(0,t.jsx)(n.strong,{children:"management"})," of certificates."]}),"\n",(0,t.jsxs)(n.h3,{id:"-installation",children:["\ud83d\udea6 ",(0,t.jsx)(n.strong,{children:"Installation:"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.9.1/cert-manager.yaml\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"-create-a-self-signed-issuer",children:["\u2705 ",(0,t.jsx)(n.strong,{children:"Create a Self-Signed Issuer:"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: cert-manager.io/v1\nkind: Issuer\nmetadata:\n  name: selfsigned-issuer\n  namespace: default\nspec:\n  selfSigned: {}\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"-requesting-a-certificate",children:["\ud83d\udd11 ",(0,t.jsx)(n.strong,{children:"Requesting a Certificate:"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: cert-manager.io/v1\nkind: Certificate\nmetadata:\n  name: selfsigned-cert\nspec:\n  secretName: selfsigned-cert-tls\n  duration: 90d\n  renewBefore: 30d\n  commonName: example.com\n  dnsNames:\n    - example.com\n  issuerRef:\n    name: selfsigned-issuer\n    kind: Issuer\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"-best-practices-for-managing-certificates",children:["\u2705 ",(0,t.jsx)(n.strong,{children:"Best Practices for Managing Certificates:"})]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Automate Renewal:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.strong,{children:"Cert-Manager"})," to avoid ",(0,t.jsx)(n.strong,{children:"expired certificates"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Enforce TLS Everywhere:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Enable ",(0,t.jsx)(n.strong,{children:"TLS"})," for all ",(0,t.jsx)(n.strong,{children:"internal"})," and ",(0,t.jsx)(n.strong,{children:"external communications"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Rotate Certificates Regularly:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Automate with ",(0,t.jsx)(n.strong,{children:"cert-manager"})," or ",(0,t.jsx)(n.strong,{children:"kubeadm cert renew"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Monitor Certificate Expiry:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Set up ",(0,t.jsx)(n.strong,{children:"alerts"})," for ",(0,t.jsx)(n.strong,{children:"expiring certificates"})," using ",(0,t.jsx)(n.strong,{children:"Prometheus"})," or ",(0,t.jsx)(n.strong,{children:"Grafana"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"-conclusion-certificates-enhance-cluster-security",children:["\ud83d\udd10 ",(0,t.jsx)(n.strong,{children:"Conclusion: Certificates Enhance Cluster Security"})]}),"\n",(0,t.jsxs)(n.p,{children:["Certificates are a ",(0,t.jsx)(n.strong,{children:"core primitive"})," in Kubernetes security, providing ",(0,t.jsx)(n.strong,{children:"encryption"})," and ",(0,t.jsx)(n.strong,{children:"authentication"})," for ",(0,t.jsx)(n.strong,{children:"API server communications"}),", ",(0,t.jsx)(n.strong,{children:"Ingress traffic"}),", and ",(0,t.jsx)(n.strong,{children:"internal service interactions"}),". Implementing certificates with tools like ",(0,t.jsx)(n.strong,{children:"Cert-Manager"})," ensures your ",(0,t.jsx)(n.strong,{children:"cluster remains secure"})," and ",(0,t.jsx)(n.strong,{children:"compliant"})," with ",(0,t.jsx)(n.strong,{children:"best practices"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Would you like more guidance on configuring ",(0,t.jsx)(n.strong,{children:"mTLS"})," between ",(0,t.jsx)(n.strong,{children:"services"}),", or need help setting up ",(0,t.jsx)(n.strong,{children:"Cert-Manager"})," for ",(0,t.jsx)(n.strong,{children:"dynamic certificate management"}),"? Let me know!"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>a});var r=s(6540);const t={},i=r.createContext(t);function c(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);