"use strict";(globalThis.webpackChunkk_8_s_security=globalThis.webpackChunkk_8_s_security||[]).push([[9855],{4993(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"fundamentals/authentication/certificates","title":"Certificates","description":"Understand the role of certificates in Kubernetes, including client certificates, server certificates, and automating certificate management with Cert-Manager.","source":"@site/docs/fundamentals/authentication/certificates.md","sourceDirName":"fundamentals/authentication","slug":"/fundamentals/authentication/certificates","permalink":"/kubernetes-security/fundamentals/authentication/certificates","draft":false,"unlisted":false,"editUrl":"https://github.com/geek-kb/k8s_security/edit/main/docs/fundamentals/authentication/certificates.md","tags":[],"version":"current","lastUpdatedBy":"Itai Ganot","lastUpdatedAt":1771236448000,"frontMatter":{"title":"Certificates","description":"Understand the role of certificates in Kubernetes, including client certificates, server certificates, and automating certificate management with Cert-Manager.","keywords":["kubernetes certificates","x509 certificates","TLS certificates","client certificates","server certificates","cert-manager","certificate management","PKI","kubernetes security","certificate rotation"]},"sidebar":"default","previous":{"title":"Service Accounts","permalink":"/kubernetes-security/fundamentals/authentication/service-accounts"},"next":{"title":"Authorization Methods","permalink":"/kubernetes-security/fundamentals/authorization/authorization-methods"}}');var s=t(4848),i=t(8453);const c={title:"Certificates",description:"Understand the role of certificates in Kubernetes, including client certificates, server certificates, and automating certificate management with Cert-Manager.",keywords:["kubernetes certificates","x509 certificates","TLS certificates","client certificates","server certificates","cert-manager","certificate management","PKI","kubernetes security","certificate rotation"]},a=void 0,l={},o=[{value:"Introduction",id:"introduction",level:2},{value:"What Are Certificates in Kubernetes?",id:"what-are-certificates-in-kubernetes",level:2},{value:"Common Use Cases for Certificates in Kubernetes",id:"common-use-cases-for-certificates-in-kubernetes",level:2},{value:"Types of Certificates in Kubernetes",id:"types-of-certificates-in-kubernetes",level:2},{value:"1. Client Certificates",id:"1-client-certificates",level:3},{value:"Use Cases for Client Certificates",id:"use-cases-for-client-certificates",level:4},{value:"Generating a Client Certificate",id:"generating-a-client-certificate",level:4},{value:"Key Differences Between Client and User Certificates",id:"key-differences-between-client-and-user-certificates",level:4},{value:"Cross-Reference",id:"cross-reference",level:4},{value:"2. Server Certificates",id:"2-server-certificates",level:3},{value:"3. TLS Certificates for Ingress Controllers",id:"3-tls-certificates-for-ingress-controllers",level:3},{value:"4. Service Account Tokens vs. Certificates",id:"4-service-account-tokens-vs-certificates",level:3},{value:"Automating Certificate Management with Cert-Manager",id:"automating-certificate-management-with-cert-manager",level:2},{value:"Installation",id:"installation",level:3},{value:"Create a Self-Signed Issuer",id:"create-a-self-signed-issuer",level:3},{value:"Requesting a Certificate",id:"requesting-a-certificate",level:3},{value:"Best Practices for Managing Certificates",id:"best-practices-for-managing-certificates",level:2},{value:"Conclusion",id:"conclusion",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsx)(n.p,{children:"Certificates play a critical role in Kubernetes security by enabling secure communication between various components of a Kubernetes cluster. They are primarily used for authenticating system components and services, ensuring data confidentiality, integrity, and authentication within the cluster."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"what-are-certificates-in-kubernetes",children:"What Are Certificates in Kubernetes?"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Certificates"})," in Kubernetes are ",(0,s.jsx)(n.strong,{children:"digital certificates"})," used to secure ",(0,s.jsx)(n.strong,{children:"communications"})," between ",(0,s.jsx)(n.strong,{children:"components"}),", enable ",(0,s.jsx)(n.strong,{children:"TLS encryption"}),", and facilitate ",(0,s.jsx)(n.strong,{children:"authentication"}),". Certificates ensure the ",(0,s.jsx)(n.strong,{children:"confidentiality"}),", ",(0,s.jsx)(n.strong,{children:"integrity"}),", and ",(0,s.jsx)(n.strong,{children:"authentication"})," of data ",(0,s.jsx)(n.strong,{children:"in transit"})," within the Kubernetes cluster."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"common-use-cases-for-certificates-in-kubernetes",children:"Common Use Cases for Certificates in Kubernetes"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Securing Kubernetes API Server Communication:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"mTLS (Mutual TLS)"})," between ",(0,s.jsx)(n.strong,{children:"API server"})," and ",(0,s.jsx)(n.strong,{children:"Kubelets"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Intra-Cluster Communication:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Enable ",(0,s.jsx)(n.strong,{children:"mTLS"})," between ",(0,s.jsx)(n.strong,{children:"pods"})," and ",(0,s.jsx)(n.strong,{children:"services"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ingress TLS/SSL Certificates:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Secure ",(0,s.jsx)(n.strong,{children:"external access"})," through ",(0,s.jsx)(n.strong,{children:"Ingress Controllers"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Authentication:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Generate ",(0,s.jsx)(n.strong,{children:"X.509 certificates"})," for ",(0,s.jsx)(n.strong,{children:"user authentication"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"types-of-certificates-in-kubernetes",children:"Types of Certificates in Kubernetes"}),"\n",(0,s.jsx)(n.h3,{id:"1-client-certificates",children:"1. Client Certificates"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Required knowledge for the CKS certification."})}),"\n",(0,s.jsx)(n.p,{children:"Client certificates are essential for secure communication between Kubernetes components. They provide mutual authentication, enabling the API server and internal services to verify each other's identities."}),"\n",(0,s.jsx)(n.h4,{id:"use-cases-for-client-certificates",children:"Use Cases for Client Certificates"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"System Component Authentication:"})," Establish secure connections between API servers, kubelets, and other internal services."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Service-to-Service Communication:"})," Secure communication within the cluster for services that require API access."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"generating-a-client-certificate",children:"Generating a Client Certificate"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'openssl req -new -newkey rsa:2048 -nodes -keyout user.key -out user.csr -subj "/CN=example-user"\n\nopenssl x509 -req -in user.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out user.crt -days 365\n'})}),"\n",(0,s.jsx)(n.h4,{id:"key-differences-between-client-and-user-certificates",children:"Key Differences Between Client and User Certificates"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Certificate Type"}),(0,s.jsx)(n.th,{children:"Purpose"}),(0,s.jsx)(n.th,{children:"Example Use Case"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Client Certificate"}),(0,s.jsx)(n.td,{children:"Component-to-component authentication"}),(0,s.jsx)(n.td,{children:"API Server to Kubelet communication"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"User Certificate"}),(0,s.jsx)(n.td,{children:"API access for external users"}),(0,s.jsxs)(n.td,{children:["Developer access via ",(0,s.jsx)(n.code,{children:"kubectl"})]})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"cross-reference",children:"Cross-Reference"}),"\n",(0,s.jsxs)(n.p,{children:["For a detailed step-by-step guide on issuing a certificate for a Kubernetes user, see ",(0,s.jsx)(n.a,{href:"/kubernetes-security/fundamentals/authentication/issue-user-certificate/",children:"How to Issue a Certificate for a Kubernetes User"}),"."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"2-server-certificates",children:"2. Server Certificates"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Required knowledge for the CKS certification."})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Secures ",(0,s.jsx)(n.strong,{children:"server endpoints"})," with ",(0,s.jsx)(n.strong,{children:"TLS encryption"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Commonly used for the ",(0,s.jsx)(n.strong,{children:"API server"}),", ",(0,s.jsx)(n.strong,{children:"Kubelets"}),", and ",(0,s.jsx)(n.strong,{children:"webhooks"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Create a server certificate for the API server\nopenssl req -new -key apiserver.key -out apiserver.csr -subj "/CN=kube-apiserver"\n\n# Sign with the Kubernetes Certificate Authority (CA)\nopenssl x509 -req -in apiserver.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out apiserver.crt -days 365\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"3-tls-certificates-for-ingress-controllers",children:"3. TLS Certificates for Ingress Controllers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Used to secure ",(0,s.jsx)(n.strong,{children:"Ingress traffic"})," using ",(0,s.jsx)(n.strong,{children:"HTTPS"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Automate with ",(0,s.jsx)(n.strong,{children:"Cert-Manager"})," and ",(0,s.jsx)(n.strong,{children:"Let's Encrypt"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Example: Issuing a TLS Certificate with Cert-Manager\napiVersion: cert-manager.io/v1\nkind: Certificate\nmetadata:\n  name: example-cert\n  namespace: default\nspec:\n  secretName: example-cert-tls\n  issuerRef:\n    name: letsencrypt-issuer\n    kind: ClusterIssuer\n  dnsNames:\n    - example.com\n    - www.example.com\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"4-service-account-tokens-vs-certificates",children:"4. Service Account Tokens vs. Certificates"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Feature"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Service Account Token"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Certificate"})})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Use Case"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Pod authentication"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"User and server authentication"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Renewal"})}),(0,s.jsx)(n.td,{children:"Automatic"}),(0,s.jsxs)(n.td,{children:["Requires ",(0,s.jsx)(n.strong,{children:"manual"})," or ",(0,s.jsx)(n.strong,{children:"automated rotation"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Security"})}),(0,s.jsxs)(n.td,{children:["Token-based ",(0,s.jsx)(n.strong,{children:"JWT"})]}),(0,s.jsxs)(n.td,{children:["Encrypted ",(0,s.jsx)(n.strong,{children:"X.509 certificates"})]})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"automating-certificate-management-with-cert-manager",children:"Automating Certificate Management with Cert-Manager"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cert-Manager"})," is a ",(0,s.jsx)(n.strong,{children:"Kubernetes add-on"})," that automates the ",(0,s.jsx)(n.strong,{children:"creation"}),", ",(0,s.jsx)(n.strong,{children:"renewal"}),", and ",(0,s.jsx)(n.strong,{children:"management"})," of certificates."]}),"\n",(0,s.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.9.1/cert-manager.yaml\n"})}),"\n",(0,s.jsx)(n.h3,{id:"create-a-self-signed-issuer",children:"Create a Self-Signed Issuer"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: cert-manager.io/v1\nkind: Issuer\nmetadata:\n  name: selfsigned-issuer\n  namespace: default\nspec:\n  selfSigned: {}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"requesting-a-certificate",children:"Requesting a Certificate"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: cert-manager.io/v1\nkind: Certificate\nmetadata:\n  name: selfsigned-cert\nspec:\n  secretName: selfsigned-cert-tls\n  duration: 90d\n  renewBefore: 30d\n  commonName: example.com\n  dnsNames:\n    - example.com\n  issuerRef:\n    name: selfsigned-issuer\n    kind: Issuer\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"best-practices-for-managing-certificates",children:"Best Practices for Managing Certificates"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Automate Renewal:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.strong,{children:"Cert-Manager"})," to avoid ",(0,s.jsx)(n.strong,{children:"expired certificates"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Enforce TLS Everywhere:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Enable ",(0,s.jsx)(n.strong,{children:"TLS"})," for all ",(0,s.jsx)(n.strong,{children:"internal"})," and ",(0,s.jsx)(n.strong,{children:"external communications"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Rotate Certificates Regularly:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Automate with ",(0,s.jsx)(n.strong,{children:"cert-manager"})," or ",(0,s.jsx)(n.strong,{children:"kubeadm cert renew"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Monitor Certificate Expiry:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Set up ",(0,s.jsx)(n.strong,{children:"alerts"})," for ",(0,s.jsx)(n.strong,{children:"expiring certificates"})," using ",(0,s.jsx)(n.strong,{children:"Prometheus"})," or ",(0,s.jsx)(n.strong,{children:"Grafana"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsxs)(n.p,{children:["Certificates are a ",(0,s.jsx)(n.strong,{children:"core primitive"})," in Kubernetes security, providing ",(0,s.jsx)(n.strong,{children:"encryption"})," and ",(0,s.jsx)(n.strong,{children:"authentication"})," for ",(0,s.jsx)(n.strong,{children:"API server communications"}),", ",(0,s.jsx)(n.strong,{children:"Ingress traffic"}),", and ",(0,s.jsx)(n.strong,{children:"internal service interactions"}),". Implementing certificates with tools like ",(0,s.jsx)(n.strong,{children:"Cert-Manager"})," ensures your ",(0,s.jsx)(n.strong,{children:"cluster remains secure"})," and ",(0,s.jsx)(n.strong,{children:"compliant"})," with ",(0,s.jsx)(n.strong,{children:"best practices"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["For more advanced scenarios, including ",(0,s.jsx)(n.strong,{children:"mTLS setup"})," between services or using ",(0,s.jsx)(n.strong,{children:"Cert-Manager"})," for dynamic certificate management, see the related documentation in this section."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsx)(n.p,{children:"This article is based on information from the following official sources:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/setup/best-practices/certificates/",children:"PKI Certificates and Requirements"})," - Kubernetes Documentation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/access-authn-authz/certificate-signing-requests/",children:"Certificate Signing Requests"})," - Kubernetes Documentation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/tls/managing-tls-in-a-cluster/",children:"Manage TLS Certificates in a Cluster"})," - Kubernetes Documentation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://cert-manager.io/docs/",children:"cert-manager Documentation"})," - CNCF cert-manager Project"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>c,x:()=>a});var r=t(6540);const s={},i=r.createContext(s);function c(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);