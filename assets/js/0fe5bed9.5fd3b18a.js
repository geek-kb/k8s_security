"use strict";(self.webpackChunkk_8_s_security=self.webpackChunkk_8_s_security||[]).push([[9557],{3342:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"best_practices/monitoring_logging_and_runtime_security/tetragon","title":"Tetragon","description":"Tetragon is a Kubernetes-aware security observability and runtime enforcement tool built on eBPF, enabling detection of malicious behavior and policy enforcement in real time.","source":"@site/docs/best_practices/monitoring_logging_and_runtime_security/tetragon.md","sourceDirName":"best_practices/monitoring_logging_and_runtime_security","slug":"/best_practices/monitoring_logging_and_runtime_security/tetragon","permalink":"/docs/best_practices/monitoring_logging_and_runtime_security/tetragon","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"Itai Ganot","lastUpdatedAt":1742824633000,"sidebarPosition":5,"frontMatter":{"title":"Tetragon","description":"Tetragon is a Kubernetes-aware security observability and runtime enforcement tool built on eBPF, enabling detection of malicious behavior and policy enforcement in real time.","sidebar_position":5},"sidebar":"default","previous":{"title":"Falco","permalink":"/docs/best_practices/monitoring_logging_and_runtime_security/falco"},"next":{"title":"kubectl-snoop","permalink":"/docs/best_practices/monitoring_logging_and_runtime_security/kubectl_snoop"}}');var s=i(4848),r=i(8453);const l={title:"Tetragon",description:"Tetragon is a Kubernetes-aware security observability and runtime enforcement tool built on eBPF, enabling detection of malicious behavior and policy enforcement in real time.",sidebar_position:5},a="Tetragon",o={},c=[{value:"Use Cases",id:"use-cases",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Install Tetragon with Helm",id:"install-tetragon-with-helm",level:3},{value:"Example: Log All Executed Binaries",id:"example-log-all-executed-binaries",level:3},{value:"Example: Enforce Runtime Policy",id:"example-enforce-runtime-policy",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"tetragon",children:"Tetragon"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Tetragon"})," is an open-source, Kubernetes-native ",(0,s.jsx)(n.strong,{children:"eBPF-based security observability and runtime enforcement tool"})," developed by the Cilium project. It allows security teams to monitor system and network activity in real time, detect malicious behavior, and enforce policies dynamically\u2014without modifying application code."]}),"\n",(0,s.jsx)(n.p,{children:"Tetragon integrates tightly with Kubernetes, delivering deep visibility into process-level activity, container lifecycle events, file access, and network communication."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Detect unexpected process executions in containers."}),"\n",(0,s.jsx)(n.li,{children:"Enforce runtime policies like blocking unauthorized binaries."}),"\n",(0,s.jsx)(n.li,{children:"Trace container and host activity at the syscall level."}),"\n",(0,s.jsx)(n.li,{children:"Observe DNS, TCP, and HTTP traffic per workload."}),"\n",(0,s.jsx)(n.li,{children:"Correlate events with Kubernetes metadata (pods, namespaces, labels)."}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,s.jsx)(n.h3,{id:"install-tetragon-with-helm",children:"Install Tetragon with Helm"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"helm repo add cilium https://helm.cilium.io\nhelm install tetragon cilium/tetragon --namespace kube-system\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-log-all-executed-binaries",children:"Example: Log All Executed Binaries"}),"\n",(0,s.jsx)(n.p,{children:"Tetragon emits events for executed processes using eBPF hooks:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl logs -n kube-system -l k8s-app=tetragon -f\n"})}),"\n",(0,s.jsx)(n.p,{children:"Example output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Process exec detected: /usr/bin/curl in pod nginx-1234 with UID 1000\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-enforce-runtime-policy",children:"Example: Enforce Runtime Policy"}),"\n",(0,s.jsxs)(n.p,{children:["Block execution of ",(0,s.jsx)(n.code,{children:"nc"})," (netcat) across all containers:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: cilium.io/v1alpha1\nkind: TracingPolicy\nmetadata:\n  name: block-netcat\nspec:\n  selectors:\n    matchBinary: ["/usr/bin/nc"]\n  action: Block\n'})}),"\n",(0,s.jsx)(n.p,{children:"Apply the policy:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f block-netcat.yaml\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Deploy cluster-wide:"})," Use the DaemonSet to monitor all nodes and containers."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use granular policies:"})," Apply Kubernetes-native enforcement using labels, namespaces, and container metadata."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Integrate with observability pipelines:"})," Send logs to SIEM or alerting systems for incident response."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use in combination with audit logs:"})," Correlate Tetragon events with Kubernetes audit logs for full visibility."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Keep eBPF programs updated:"})," Monitor upstream releases for security and kernel compatibility updates."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Official Documentation:"})," ",(0,s.jsx)(n.a,{href:"https://docs.cilium.io/en/stable/observability/tetragon/",children:"https://docs.cilium.io/en/stable/observability/tetragon/"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"GitHub Repository:"})," ",(0,s.jsx)(n.a,{href:"https://github.com/cilium/tetragon",children:"https://github.com/cilium/tetragon"})]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var t=i(6540);const s={},r=t.createContext(s);function l(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);