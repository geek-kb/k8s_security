"use strict";(globalThis.webpackChunkk_8_s_security=globalThis.webpackChunkk_8_s_security||[]).push([[2829],{5746(e,s,c){c.r(s),c.d(s,{assets:()=>l,contentTitle:()=>t,default:()=>u,frontMatter:()=>a,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"best-practices/cluster-setup-and-hardening/rbac-and-identity/rakkess","title":"rakkess","description":"rakkess displays an access matrix showing which Kubernetes resources a user, group, or service account can access, providing a comprehensive RBAC overview.","source":"@site/docs/best-practices/cluster-setup-and-hardening/rbac-and-identity/rakkess.md","sourceDirName":"best-practices/cluster-setup-and-hardening/rbac-and-identity","slug":"/best-practices/cluster-setup-and-hardening/rbac-and-identity/rakkess","permalink":"/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/rakkess","draft":false,"unlisted":false,"editUrl":"https://github.com/geek-kb/k8s_security/edit/main/docs/best-practices/cluster-setup-and-hardening/rbac-and-identity/rakkess.md","tags":[{"inline":true,"label":"tool","permalink":"/kubernetes-security/tags/tool"},{"inline":true,"label":"rbac","permalink":"/kubernetes-security/tags/rbac"},{"inline":true,"label":"authorization","permalink":"/kubernetes-security/tags/authorization"},{"inline":true,"label":"CKS","permalink":"/kubernetes-security/tags/cks"}],"version":"current","lastUpdatedBy":"Itai Ganot","lastUpdatedAt":1771236448000,"sidebarPosition":16,"frontMatter":{"sidebar_position":16,"title":"rakkess","description":"rakkess displays an access matrix showing which Kubernetes resources a user, group, or service account can access, providing a comprehensive RBAC overview.","keywords":["kubernetes security tool","rakkess","RBAC matrix","access review","kubernetes authorization","permission overview","security audit","access control","CKS"],"tags":["tool","rbac","authorization","CKS"],"related":["/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/insecure-rbac-permissions-mitigation/","/kubernetes-security/fundamentals/authorization/rbac/","/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/kubectl-who-can/"]},"sidebar":"default","previous":{"title":"kubectl-who-can","permalink":"/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/kubectl-who-can"},"next":{"title":"rback","permalink":"/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/rback"}}');var r=c(4848),i=c(8453);const a={sidebar_position:16,title:"rakkess",description:"rakkess displays an access matrix showing which Kubernetes resources a user, group, or service account can access, providing a comprehensive RBAC overview.",keywords:["kubernetes security tool","rakkess","RBAC matrix","access review","kubernetes authorization","permission overview","security audit","access control","CKS"],tags:["tool","rbac","authorization","CKS"],related:["/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/insecure-rbac-permissions-mitigation/","/kubernetes-security/fundamentals/authorization/rbac/","/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/kubectl-who-can/"]},t="rakkess",l={},d=[{value:"Use Cases",id:"use-cases",level:2},{value:"Installation",id:"installation",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Show Access Matrix for Current User",id:"show-access-matrix-for-current-user",level:3},{value:"Check Access for a Specific Service Account",id:"check-access-for-a-specific-service-account",level:3},{value:"Check Access in a Specific Namespace",id:"check-access-in-a-specific-namespace",level:3},{value:"Check Access for a User",id:"check-access-for-a-user",level:3},{value:"Check Access for a Group",id:"check-access-for-a-group",level:3},{value:"Include All Verbs",id:"include-all-verbs",level:3},{value:"Filter by Resource",id:"filter-by-resource",level:3},{value:"Output Formats",id:"output-formats",level:3},{value:"Understanding the Access Matrix",id:"understanding-the-access-matrix",level:2},{value:"Verb Meanings",id:"verb-meanings",level:3},{value:"Common Audit Scenarios",id:"common-audit-scenarios",level:2},{value:"Audit Service Account Permissions",id:"audit-service-account-permissions",level:3},{value:"Compare User Permissions",id:"compare-user-permissions",level:3},{value:"Check Cluster-Wide Access",id:"check-cluster-wide-access",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"References",id:"references",level:2}];function o(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"rakkess",children:"rakkess"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"rakkess"})," (Review Access - kubectl plugin) displays an access matrix for Kubernetes resources, showing at a glance which resources a given subject can access. It provides a comprehensive overview of effective permissions, making it easier to audit RBAC configurations and identify potential security issues."]}),"\n",(0,r.jsxs)(s.p,{children:["Unlike ",(0,r.jsx)(s.code,{children:"kubectl auth can-i"})," which checks individual permissions, rakkess shows all permissions across all resource types in a single matrix view."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Quickly audit effective permissions for users, groups, or service accounts."}),"\n",(0,r.jsx)(s.li,{children:"Identify resources that a subject should not have access to."}),"\n",(0,r.jsx)(s.li,{children:"Compare permissions across different subjects or namespaces."}),"\n",(0,r.jsx)(s.li,{children:"Validate RBAC configurations during security reviews."}),"\n",(0,r.jsx)(s.li,{children:"Document access controls for compliance requirements."}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(s.p,{children:"Install rakkess using krew (the kubectl plugin manager):"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"kubectl krew install access-matrix\n"})}),"\n",(0,r.jsx)(s.p,{children:"Or download directly from GitHub releases:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"curl -LO https://github.com/corneliusweig/rakkess/releases/download/v0.5.0/rakkess-amd64-linux.tar.gz\ntar xzf rakkess-amd64-linux.tar.gz\nchmod +x rakkess-amd64-linux\nsudo mv rakkess-amd64-linux /usr/local/bin/kubectl-access_matrix\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,r.jsx)(s.h3,{id:"show-access-matrix-for-current-user",children:"Show Access Matrix for Current User"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"kubectl access-matrix\n"})}),"\n",(0,r.jsx)(s.p,{children:"Example output:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"NAME                                  LIST  CREATE  UPDATE  DELETE\nbindings                                          \u2714\nconfigmaps                            \u2714     \u2714       \u2714       \u2714\nendpoints                             \u2714     \u2714       \u2714       \u2714\nevents                                \u2714\nlimitranges                           \u2714\nnamespaces                            \u2714\nnodes                                 \u2714\npersistentvolumeclaims                \u2714     \u2714       \u2714       \u2714\npersistentvolumes                     \u2714\npods                                  \u2714     \u2714       \u2714       \u2714\npods/exec                                   \u2714\npods/log                              \u2714\nsecrets                               \u2714     \u2714       \u2714       \u2714\nserviceaccounts                       \u2714     \u2714       \u2714       \u2714\nservices                              \u2714     \u2714       \u2714       \u2714\n"})}),"\n",(0,r.jsx)(s.h3,{id:"check-access-for-a-specific-service-account",children:"Check Access for a Specific Service Account"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"kubectl access-matrix --as system:serviceaccount:my-namespace:my-sa\n"})}),"\n",(0,r.jsx)(s.h3,{id:"check-access-in-a-specific-namespace",children:"Check Access in a Specific Namespace"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"kubectl access-matrix -n production\n"})}),"\n",(0,r.jsx)(s.h3,{id:"check-access-for-a-user",children:"Check Access for a User"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"kubectl access-matrix --as jane@example.com\n"})}),"\n",(0,r.jsx)(s.h3,{id:"check-access-for-a-group",children:"Check Access for a Group"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"kubectl access-matrix --as-group developers\n"})}),"\n",(0,r.jsx)(s.h3,{id:"include-all-verbs",children:"Include All Verbs"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"kubectl access-matrix --verbs=get,list,watch,create,update,patch,delete,deletecollection\n"})}),"\n",(0,r.jsx)(s.h3,{id:"filter-by-resource",children:"Filter by Resource"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"kubectl access-matrix --resource secrets\n"})}),"\n",(0,r.jsx)(s.h3,{id:"output-formats",children:"Output Formats"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# JSON output\nkubectl access-matrix -o json\n\n# Wide output (shows all verbs)\nkubectl access-matrix -o wide\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"understanding-the-access-matrix",children:"Understanding the Access Matrix"}),"\n",(0,r.jsx)(s.p,{children:"The matrix displays:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Rows:"})," Kubernetes resource types (pods, secrets, configmaps, etc.)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Columns:"})," Verbs (list, create, update, delete, etc.)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Cells:"})," Checkmarks indicate allowed actions"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"verb-meanings",children:"Verb Meanings"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Verb"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"get"}),(0,r.jsx)(s.td,{children:"Read a specific resource by name"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"list"}),(0,r.jsx)(s.td,{children:"List all resources of a type"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"watch"}),(0,r.jsx)(s.td,{children:"Watch for changes to resources"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"create"}),(0,r.jsx)(s.td,{children:"Create new resources"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"update"}),(0,r.jsx)(s.td,{children:"Replace existing resources"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"patch"}),(0,r.jsx)(s.td,{children:"Partially modify resources"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"delete"}),(0,r.jsx)(s.td,{children:"Delete specific resources"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"deletecollection"}),(0,r.jsx)(s.td,{children:"Delete multiple resources at once"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"common-audit-scenarios",children:"Common Audit Scenarios"}),"\n",(0,r.jsx)(s.h3,{id:"audit-service-account-permissions",children:"Audit Service Account Permissions"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Check default service account in each namespace\nfor ns in $(kubectl get ns -o jsonpath='{.items[*].metadata.name}'); do\n  echo \"=== Namespace: $ns ===\"\n  kubectl access-matrix --as system:serviceaccount:$ns:default -n $ns\ndone\n"})}),"\n",(0,r.jsx)(s.h3,{id:"compare-user-permissions",children:"Compare User Permissions"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Developer access\nkubectl access-matrix --as developer@example.com -n development\n\n# Admin access\nkubectl access-matrix --as admin@example.com -n development\n"})}),"\n",(0,r.jsx)(s.h3,{id:"check-cluster-wide-access",children:"Check Cluster-Wide Access"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"kubectl access-matrix --all-namespaces\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Regular audits:"})," Run access-matrix checks regularly to detect permission drift."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Focus on sensitive resources:"})," Pay special attention to secrets, RBAC resources, and pod execution permissions."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Compare against baseline:"})," Document expected permissions and compare against actual access."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Check service accounts:"})," Audit service accounts in all namespaces, especially the default service account."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Combine with other tools:"})," Use alongside kubectl-who-can for bidirectional RBAC analysis."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"references",children:"References"}),"\n",(0,r.jsx)(s.p,{children:"This article is based on information from the following official sources:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"https://github.com/corneliusweig/rakkess",children:"rakkess GitHub Repository"})," - GitHub"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"https://kubernetes.io/docs/reference/access-authn-authz/rbac/",children:"Using RBAC Authorization"})," - Kubernetes Documentation"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"https://kubernetes.io/docs/reference/access-authn-authz/authorization/#checking-api-access",children:"Checking API Access"})," - Kubernetes Documentation"]}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453(e,s,c){c.d(s,{R:()=>a,x:()=>t});var n=c(6540);const r={},i=n.createContext(r);function a(e){const s=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),n.createElement(i.Provider,{value:s},e.children)}}}]);