"use strict";(globalThis.webpackChunkk_8_s_security=globalThis.webpackChunkk_8_s_security||[]).push([[7510],{6124(e,s,n){n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"tools/red_kube","title":"red-kube","description":"red-kube is a Kubernetes adversary emulation framework based on kubectl, providing attack simulations aligned with MITRE ATT&CK tactics.","source":"@site/docs/tools/red_kube.md","sourceDirName":"tools","slug":"/tools/red_kube","permalink":"/docs/tools/red_kube","draft":false,"unlisted":false,"editUrl":"https://github.com/geek-kb/k8s_security/edit/main/docs/tools/red_kube.md","tags":[{"inline":true,"label":"tool","permalink":"/docs/tags/tool"},{"inline":true,"label":"penetration-testing","permalink":"/docs/tags/penetration-testing"},{"inline":true,"label":"adversary-emulation","permalink":"/docs/tags/adversary-emulation"}],"version":"current","lastUpdatedBy":"Itai Ganot","lastUpdatedAt":1771232119000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"red-kube","description":"red-kube is a Kubernetes adversary emulation framework based on kubectl, providing attack simulations aligned with MITRE ATT&CK tactics.","keywords":["kubernetes security tool","red-kube","adversary emulation","MITRE ATT&CK","kubernetes attacks","red team","security testing","attack simulation","CKS"],"tags":["tool","penetration-testing","adversary-emulation"],"related":["/docs/tools/cdk/","/docs/tools/kdigger/","/docs/attack_vectors/privileged_container_escape/"]}}');var a=n(4848),i=n(8453);const c={sidebar_position:4,title:"red-kube",description:"red-kube is a Kubernetes adversary emulation framework based on kubectl, providing attack simulations aligned with MITRE ATT&CK tactics.",keywords:["kubernetes security tool","red-kube","adversary emulation","MITRE ATT&CK","kubernetes attacks","red team","security testing","attack simulation","CKS"],tags:["tool","penetration-testing","adversary-emulation"],related:["/docs/tools/cdk/","/docs/tools/kdigger/","/docs/attack_vectors/privileged_container_escape/"]},r="red-kube",l={},d=[{value:"Use Cases",id:"use-cases",level:2},{value:"Attack Categories",id:"attack-categories",level:2},{value:"Installation",id:"installation",level:2},{value:"Clone Repository",id:"clone-repository",level:3},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Attack Techniques",id:"attack-techniques",level:2},{value:"Initial Access",id:"initial-access",level:3},{value:"Exposed Kubernetes Dashboard",id:"exposed-kubernetes-dashboard",level:4},{value:"Compromised Image",id:"compromised-image",level:4},{value:"Execution",id:"execution",level:3},{value:"Container Command Execution",id:"container-command-execution",level:4},{value:"Malicious Workload Deployment",id:"malicious-workload-deployment",level:4},{value:"Persistence",id:"persistence",level:3},{value:"Create Backdoor Service Account",id:"create-backdoor-service-account",level:4},{value:"Deploy Backdoor DaemonSet",id:"deploy-backdoor-daemonset",level:4},{value:"Create CronJob Backdoor",id:"create-cronjob-backdoor",level:4},{value:"Privilege Escalation",id:"privilege-escalation",level:3},{value:"Privileged Pod Creation",id:"privileged-pod-creation",level:4},{value:"RBAC Escalation",id:"rbac-escalation",level:4},{value:"Service Account Token Theft",id:"service-account-token-theft",level:4},{value:"Defense Evasion",id:"defense-evasion",level:3},{value:"Delete Kubernetes Events",id:"delete-kubernetes-events",level:4},{value:"Deploy in kube-system",id:"deploy-in-kube-system",level:4},{value:"Disable Audit Logging",id:"disable-audit-logging",level:4},{value:"Credential Access",id:"credential-access",level:3},{value:"Extract Secrets",id:"extract-secrets",level:4},{value:"Access Cloud Credentials",id:"access-cloud-credentials",level:4},{value:"Dump ConfigMaps",id:"dump-configmaps",level:4},{value:"Discovery",id:"discovery",level:3},{value:"Enumerate Cluster",id:"enumerate-cluster",level:4},{value:"Find Privileged Pods",id:"find-privileged-pods",level:4},{value:"Map Network Services",id:"map-network-services",level:4},{value:"Lateral Movement",id:"lateral-movement",level:3},{value:"Pod Hopping",id:"pod-hopping",level:4},{value:"Access Other Namespaces",id:"access-other-namespaces",level:4},{value:"Impact",id:"impact",level:3},{value:"Resource Exhaustion",id:"resource-exhaustion",level:4},{value:"Delete Critical Workloads",id:"delete-critical-workloads",level:4},{value:"Data Encryption (Ransomware Simulation)",id:"data-encryption-ransomware-simulation",level:4},{value:"Running a Full Exercise",id:"running-a-full-exercise",level:2},{value:"1. Setup Test Environment",id:"1-setup-test-environment",level:3},{value:"2. Run Attack Chain",id:"2-run-attack-chain",level:3},{value:"3. Verify Detection",id:"3-verify-detection",level:3},{value:"4. Cleanup",id:"4-cleanup",level:3},{value:"Creating Custom Attacks",id:"creating-custom-attacks",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Integration with Detection",id:"integration-with-detection",level:2},{value:"Test Falco Rules",id:"test-falco-rules",level:3},{value:"Test Audit Policies",id:"test-audit-policies",level:3},{value:"References",id:"references",level:2}];function o(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"red-kube",children:"red-kube"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"red-kube"})," is a Kubernetes adversary emulation tool that simulates attack techniques based on the MITRE ATT&CK framework. Built on kubectl, it provides a collection of attack scripts that help security teams test their Kubernetes defenses by emulating real-world attacker behavior."]}),"\n",(0,a.jsx)(s.p,{children:"The tool is designed for red team exercises, security assessments, and validating detection capabilities."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Test Kubernetes security controls against known attack techniques."}),"\n",(0,a.jsx)(s.li,{children:"Validate detection and alerting capabilities (Falco, audit logs)."}),"\n",(0,a.jsx)(s.li,{children:"Conduct red team exercises in Kubernetes environments."}),"\n",(0,a.jsx)(s.li,{children:"Train security teams on Kubernetes attack patterns."}),"\n",(0,a.jsx)(s.li,{children:"Measure mean time to detect (MTTD) for various attacks."}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"attack-categories",children:"Attack Categories"}),"\n",(0,a.jsx)(s.p,{children:"red-kube organizes attacks by MITRE ATT&CK tactics:"}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Tactic"}),(0,a.jsx)(s.th,{children:"Description"})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Initial Access"}),(0,a.jsx)(s.td,{children:"Techniques to gain entry"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Execution"}),(0,a.jsx)(s.td,{children:"Running malicious code"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Persistence"}),(0,a.jsx)(s.td,{children:"Maintaining access"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Privilege Escalation"}),(0,a.jsx)(s.td,{children:"Gaining higher privileges"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Defense Evasion"}),(0,a.jsx)(s.td,{children:"Avoiding detection"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Credential Access"}),(0,a.jsx)(s.td,{children:"Stealing credentials"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Discovery"}),(0,a.jsx)(s.td,{children:"Mapping the environment"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Lateral Movement"}),(0,a.jsx)(s.td,{children:"Moving between resources"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Collection"}),(0,a.jsx)(s.td,{children:"Gathering target data"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Exfiltration"}),(0,a.jsx)(s.td,{children:"Stealing data"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Impact"}),(0,a.jsx)(s.td,{children:"Disruption and damage"})]})]})]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"installation",children:"Installation"}),"\n",(0,a.jsx)(s.h3,{id:"clone-repository",children:"Clone Repository"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"git clone https://github.com/lightspin-tech/red-kube.git\ncd red-kube\n"})}),"\n",(0,a.jsx)(s.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"kubectl configured with cluster access"}),"\n",(0,a.jsx)(s.li,{children:"Appropriate permissions for attack simulation"}),"\n",(0,a.jsx)(s.li,{children:"Test namespace (avoid production)"}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"attack-techniques",children:"Attack Techniques"}),"\n",(0,a.jsx)(s.h3,{id:"initial-access",children:"Initial Access"}),"\n",(0,a.jsx)(s.h4,{id:"exposed-kubernetes-dashboard",children:"Exposed Kubernetes Dashboard"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/initial-access/exposed-dashboard.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Checks for exposed dashboard and attempts access."}),"\n",(0,a.jsx)(s.h4,{id:"compromised-image",children:"Compromised Image"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/initial-access/deploy-malicious-image.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Deploys a pod with a potentially malicious image."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"execution",children:"Execution"}),"\n",(0,a.jsx)(s.h4,{id:"container-command-execution",children:"Container Command Execution"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/execution/exec-into-pod.sh <pod-name> <namespace>\n"})}),"\n",(0,a.jsx)(s.p,{children:"Executes commands inside a running pod."}),"\n",(0,a.jsx)(s.h4,{id:"malicious-workload-deployment",children:"Malicious Workload Deployment"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/execution/deploy-crypto-miner.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Deploys a simulated crypto miner workload."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"persistence",children:"Persistence"}),"\n",(0,a.jsx)(s.h4,{id:"create-backdoor-service-account",children:"Create Backdoor Service Account"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/persistence/create-backdoor-sa.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Creates a service account with elevated privileges."}),"\n",(0,a.jsx)(s.h4,{id:"deploy-backdoor-daemonset",children:"Deploy Backdoor DaemonSet"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/persistence/backdoor-daemonset.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Deploys a DaemonSet for persistent access across nodes."}),"\n",(0,a.jsx)(s.h4,{id:"create-cronjob-backdoor",children:"Create CronJob Backdoor"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/persistence/cronjob-backdoor.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Creates a CronJob for periodic command execution."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"privilege-escalation",children:"Privilege Escalation"}),"\n",(0,a.jsx)(s.h4,{id:"privileged-pod-creation",children:"Privileged Pod Creation"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/privilege-escalation/create-privileged-pod.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Creates a pod with privileged security context."}),"\n",(0,a.jsx)(s.h4,{id:"rbac-escalation",children:"RBAC Escalation"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/privilege-escalation/rbac-escalation.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Attempts to create cluster-admin binding."}),"\n",(0,a.jsx)(s.h4,{id:"service-account-token-theft",children:"Service Account Token Theft"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/privilege-escalation/steal-sa-token.sh <pod-name>\n"})}),"\n",(0,a.jsx)(s.p,{children:"Extracts service account tokens from pods."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"defense-evasion",children:"Defense Evasion"}),"\n",(0,a.jsx)(s.h4,{id:"delete-kubernetes-events",children:"Delete Kubernetes Events"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/defense-evasion/delete-events.sh <namespace>\n"})}),"\n",(0,a.jsx)(s.p,{children:"Attempts to delete events to hide activity."}),"\n",(0,a.jsx)(s.h4,{id:"deploy-in-kube-system",children:"Deploy in kube-system"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/defense-evasion/deploy-to-kube-system.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Deploys workloads in kube-system to blend in."}),"\n",(0,a.jsx)(s.h4,{id:"disable-audit-logging",children:"Disable Audit Logging"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/defense-evasion/disable-audit.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Attempts to modify audit logging configuration."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"credential-access",children:"Credential Access"}),"\n",(0,a.jsx)(s.h4,{id:"extract-secrets",children:"Extract Secrets"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/credential-access/extract-secrets.sh <namespace>\n"})}),"\n",(0,a.jsx)(s.p,{children:"Lists and extracts secrets from a namespace."}),"\n",(0,a.jsx)(s.h4,{id:"access-cloud-credentials",children:"Access Cloud Credentials"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/credential-access/cloud-metadata-access.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Attempts to access cloud provider metadata service."}),"\n",(0,a.jsx)(s.h4,{id:"dump-configmaps",children:"Dump ConfigMaps"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/credential-access/dump-configmaps.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Extracts potentially sensitive ConfigMap data."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"discovery",children:"Discovery"}),"\n",(0,a.jsx)(s.h4,{id:"enumerate-cluster",children:"Enumerate Cluster"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/discovery/enumerate-cluster.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Performs comprehensive cluster enumeration."}),"\n",(0,a.jsx)(s.h4,{id:"find-privileged-pods",children:"Find Privileged Pods"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/discovery/find-privileged-pods.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Identifies pods running with elevated privileges."}),"\n",(0,a.jsx)(s.h4,{id:"map-network-services",children:"Map Network Services"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/discovery/map-services.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Discovers services and endpoints in the cluster."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"lateral-movement",children:"Lateral Movement"}),"\n",(0,a.jsx)(s.h4,{id:"pod-hopping",children:"Pod Hopping"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/lateral-movement/pod-hop.sh <source-pod> <target-pod>\n"})}),"\n",(0,a.jsx)(s.p,{children:"Demonstrates movement between pods."}),"\n",(0,a.jsx)(s.h4,{id:"access-other-namespaces",children:"Access Other Namespaces"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/lateral-movement/cross-namespace.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Attempts to access resources in other namespaces."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"impact",children:"Impact"}),"\n",(0,a.jsx)(s.h4,{id:"resource-exhaustion",children:"Resource Exhaustion"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/impact/resource-exhaustion.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Creates pods that consume excessive resources."}),"\n",(0,a.jsx)(s.h4,{id:"delete-critical-workloads",children:"Delete Critical Workloads"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/impact/delete-workloads.sh <namespace>\n"})}),"\n",(0,a.jsx)(s.p,{children:"Demonstrates impact of deletion attacks."}),"\n",(0,a.jsx)(s.h4,{id:"data-encryption-ransomware-simulation",children:"Data Encryption (Ransomware Simulation)"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./attacks/impact/encrypt-pv-data.sh\n"})}),"\n",(0,a.jsx)(s.p,{children:"Simulates data encryption on persistent volumes."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"running-a-full-exercise",children:"Running a Full Exercise"}),"\n",(0,a.jsx)(s.h3,{id:"1-setup-test-environment",children:"1. Setup Test Environment"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"# Create test namespace\nkubectl create namespace red-kube-test\n\n# Deploy target workloads\nkubectl apply -f test-workloads/ -n red-kube-test\n"})}),"\n",(0,a.jsx)(s.h3,{id:"2-run-attack-chain",children:"2. Run Attack Chain"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"# Discovery\n./attacks/discovery/enumerate-cluster.sh\n\n# Initial access (if applicable)\n./attacks/initial-access/deploy-malicious-image.sh\n\n# Privilege escalation\n./attacks/privilege-escalation/create-privileged-pod.sh\n\n# Persistence\n./attacks/persistence/create-backdoor-sa.sh\n\n# Credential access\n./attacks/credential-access/extract-secrets.sh red-kube-test\n"})}),"\n",(0,a.jsx)(s.h3,{id:"3-verify-detection",children:"3. Verify Detection"}),"\n",(0,a.jsx)(s.p,{children:"Check if security tools detected the attacks:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"# Check Falco alerts\nkubectl logs -n falco -l app=falco\n\n# Review audit logs\nkubectl logs -n kube-system -l component=kube-apiserver | grep audit\n"})}),"\n",(0,a.jsx)(s.h3,{id:"4-cleanup",children:"4. Cleanup"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"./cleanup/full-cleanup.sh\nkubectl delete namespace red-kube-test\n"})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"creating-custom-attacks",children:"Creating Custom Attacks"}),"\n",(0,a.jsx)(s.p,{children:"Extend red-kube with custom attack scripts:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:'#!/bin/bash\n# attacks/custom/my-attack.sh\n\nNAMESPACE=${1:-default}\n\necho "[*] Running custom attack..."\n\n# Custom attack logic using kubectl\nkubectl get secrets -n $NAMESPACE -o yaml\n\necho "[+] Attack complete"\n'})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Use dedicated test environments:"})," Never run attacks in production."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Get proper authorization:"})," Document approval for red team exercises."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Monitor detections:"})," Use attacks to validate security monitoring."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Clean up thoroughly:"})," Remove all attack artifacts after exercises."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Document findings:"})," Create reports with recommendations."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Iterate on defenses:"})," Use results to improve security controls."]}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"integration-with-detection",children:"Integration with Detection"}),"\n",(0,a.jsx)(s.h3,{id:"test-falco-rules",children:"Test Falco Rules"}),"\n",(0,a.jsx)(s.p,{children:"Run attacks and verify Falco detects them:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"# Run attack\n./attacks/credential-access/extract-secrets.sh default\n\n# Check Falco\nkubectl logs -n falco -l app=falco | grep -i secret\n"})}),"\n",(0,a.jsx)(s.h3,{id:"test-audit-policies",children:"Test Audit Policies"}),"\n",(0,a.jsx)(s.p,{children:"Verify audit logging captures attack activity:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"# Run attack\n./attacks/persistence/create-backdoor-sa.sh\n\n# Check audit logs\nkubectl logs -n kube-system -l component=kube-apiserver | grep -i serviceaccount\n"})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"references",children:"References"}),"\n",(0,a.jsx)(s.p,{children:"This article is based on information from the following official sources:"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"https://github.com/lightspin-tech/red-kube",children:"red-kube GitHub Repository"})," - Lightspin"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"https://attack.mitre.org/matrices/enterprise/containers/",children:"MITRE ATT&CK for Containers"})," - MITRE"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"https://kubernetes.io/docs/concepts/security/",children:"Kubernetes Security"})," - Kubernetes Documentation"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},8453(e,s,n){n.d(s,{R:()=>c,x:()=>r});var t=n(6540);const a={},i=t.createContext(a);function c(e){const s=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);