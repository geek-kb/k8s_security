"use strict";(globalThis.webpackChunkk_8_s_security=globalThis.webpackChunkk_8_s_security||[]).push([[4006],{1596(e,s,n){n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>c,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"best_practices/cluster_setup_and_hardening/pod_security/pod_security_standards","title":"Pod Security Standards (PSS)","description":"Learn how Kubernetes Pod Security Standards (PSS) enforce security controls for workloads and replace the deprecated Pod Security Policies (PSP).","source":"@site/docs/best_practices/cluster_setup_and_hardening/pod_security/pod_security_standards.md","sourceDirName":"best_practices/cluster_setup_and_hardening/pod_security","slug":"/best_practices/cluster_setup_and_hardening/pod_security/pod_security_standards","permalink":"/docs/best_practices/cluster_setup_and_hardening/pod_security/pod_security_standards","draft":false,"unlisted":false,"editUrl":"https://github.com/geek-kb/k8s_security/edit/main/docs/best_practices/cluster_setup_and_hardening/pod_security/pod_security_standards.md","tags":[{"inline":true,"label":"best-practice","permalink":"/docs/tags/best-practice"},{"inline":true,"label":"pod-security","permalink":"/docs/tags/pod-security"},{"inline":true,"label":"admission-control","permalink":"/docs/tags/admission-control"},{"inline":true,"label":"CKS","permalink":"/docs/tags/cks"}],"version":"current","lastUpdatedBy":"Itai Ganot","lastUpdatedAt":1770102262000,"sidebarPosition":6,"frontMatter":{"title":"Pod Security Standards (PSS)","sidebar_position":6,"description":"Learn how Kubernetes Pod Security Standards (PSS) enforce security controls for workloads and replace the deprecated Pod Security Policies (PSP).","keywords":["kubernetes security best practices","pod security standards","PSS","pod security policy","PSP replacement","restricted profile","baseline profile","privileged profile","pod security admission","CKS"],"tags":["best-practice","pod-security","admission-control","CKS"],"related":["/docs/attack_vectors/privileged_container_escape/","/docs/best_practices/cluster_setup_and_hardening/pod_security/seccomp_in_pods/","/docs/best_practices/cluster_setup_and_hardening/pod_security/app_armor_profiles/","/docs/best_practices/cluster_setup_and_hardening/api_server_security/opa_gatekeeper/"]},"sidebar":"default","previous":{"title":"Pod Sandboxing","permalink":"/docs/best_practices/cluster_setup_and_hardening/pod_security/pod_sandboxing"},"next":{"title":"Seccomp in Pods","permalink":"/docs/best_practices/cluster_setup_and_hardening/pod_security/seccomp_in_pods"}}');var i=n(4848),t=n(8453);const c={title:"Pod Security Standards (PSS)",sidebar_position:6,description:"Learn how Kubernetes Pod Security Standards (PSS) enforce security controls for workloads and replace the deprecated Pod Security Policies (PSP).",keywords:["kubernetes security best practices","pod security standards","PSS","pod security policy","PSP replacement","restricted profile","baseline profile","privileged profile","pod security admission","CKS"],tags:["best-practice","pod-security","admission-control","CKS"],related:["/docs/attack_vectors/privileged_container_escape/","/docs/best_practices/cluster_setup_and_hardening/pod_security/seccomp_in_pods/","/docs/best_practices/cluster_setup_and_hardening/pod_security/app_armor_profiles/","/docs/best_practices/cluster_setup_and_hardening/api_server_security/opa_gatekeeper/"]},o="Pod Security Standards (PSS) in Kubernetes",a={},d=[{value:"Pod Security Standards Levels",id:"pod-security-standards-levels",level:2},{value:"1. Privileged",id:"1-privileged",level:3},{value:"2. Baseline",id:"2-baseline",level:3},{value:"3. Restricted",id:"3-restricted",level:3},{value:"Enforcing Pod Security Standards",id:"enforcing-pod-security-standards",level:2},{value:"Enforcement Modes",id:"enforcement-modes",level:3},{value:"Example: Apply Restricted Policy to a Namespace",id:"example-apply-restricted-policy-to-a-namespace",level:3},{value:"Cluster-Wide Default Policy",id:"cluster-wide-default-policy",level:3},{value:"Best Practices for Pod Security Standards",id:"best-practices-for-pod-security-standards",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"References",id:"references",level:2}];function l(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"pod-security-standards-pss-in-kubernetes",children:"Pod Security Standards (PSS) in Kubernetes"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Required knowledge for the CKS certification."})}),"\n",(0,i.jsx)(s.p,{children:"Pod Security Standards (PSS) define security guidelines for Kubernetes pods based on their security context. PSS replaced the deprecated Pod Security Policies (PSP) starting in Kubernetes v1.25 and became the standard enforcement mechanism. As of Kubernetes v1.34, PSS is the recommended approach for enforcing pod-level security. PSS categorizes security into three levels: Privileged, Baseline, and Restricted."}),"\n",(0,i.jsx)(s.p,{children:"PSS enforcement is built directly into the Kubernetes API server and applies at the namespace level using admission control."}),"\n",(0,i.jsxs)(s.p,{children:["For an overview of security best practices, refer to ",(0,i.jsx)(s.a,{href:"/docs/best_practices/cluster_setup_and_hardening/intro",children:"Cluster Setup and Hardening"}),"."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"pod-security-standards-levels",children:"Pod Security Standards Levels"}),"\n",(0,i.jsx)(s.h3,{id:"1-privileged",children:"1. Privileged"}),"\n",(0,i.jsx)(s.p,{children:"The Privileged policy provides unrestricted access and allows all possible capabilities. It is the least secure option and should be used only for trusted system-level workloads."}),"\n",(0,i.jsx)(s.p,{children:"Characteristics:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["No restrictions on pod configuration",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(s.li,{children:["Full access to host resources including network, PID, and IPC namespaces",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(s.li,{children:["Allows privileged containers with elevated capabilities",(0,i.jsx)("br",{})]}),"\n",(0,i.jsx)(s.li,{children:"Permits use of hostPath volumes and hostNetwork"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Use case: System daemons, CNI plugins, and cluster infrastructure components that require deep host integration."}),"\n",(0,i.jsx)(s.h3,{id:"2-baseline",children:"2. Baseline"}),"\n",(0,i.jsx)(s.p,{children:"The Baseline policy implements fundamental security practices that prevent known privilege escalations while remaining broadly compatible with common application requirements."}),"\n",(0,i.jsx)(s.p,{children:"Characteristics:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Prevents privilege escalation via ",(0,i.jsx)(s.code,{children:"allowPrivilegeEscalation: false"}),(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(s.li,{children:["Blocks use of host namespaces (hostNetwork, hostPID, hostIPC)",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(s.li,{children:["Restricts hostPath volumes to read-only",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(s.li,{children:["Disallows privileged containers",(0,i.jsx)("br",{})]}),"\n",(0,i.jsx)(s.li,{children:"Limits certain Linux capabilities"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Use case: General applications in development environments and workloads that do not require elevated permissions."}),"\n",(0,i.jsx)(s.h3,{id:"3-restricted",children:"3. Restricted"}),"\n",(0,i.jsx)(s.p,{children:"The Restricted policy enforces current pod hardening best practices and follows defense-in-depth principles. It is the most secure option and recommended for production environments."}),"\n",(0,i.jsx)(s.p,{children:"Characteristics:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Requires running as non-root user",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(s.li,{children:["Enforces read-only root filesystem",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(s.li,{children:["Drops all capabilities except NET_BIND_SERVICE",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(s.li,{children:["Disallows privilege escalation completely",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(s.li,{children:["Blocks all hostPath, hostNetwork, hostPID, and hostIPC usage",(0,i.jsx)("br",{})]}),"\n",(0,i.jsx)(s.li,{children:"Restricts volume types to configMap, emptyDir, projected, secret, downwardAPI, persistentVolumeClaim"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Use case: Production workloads, multi-tenant environments, and security-sensitive applications."}),"\n",(0,i.jsxs)(s.p,{children:["For more details on restricting workloads, see ",(0,i.jsx)(s.a,{href:"/docs/best_practices/cluster_setup_and_hardening/pod_security/container_escape_mitigation",children:"Container Escape Mitigation"}),"."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"enforcing-pod-security-standards",children:"Enforcing Pod Security Standards"}),"\n",(0,i.jsx)(s.p,{children:"Pod Security Standards are enforced using the Pod Security admission controller, which is built into the Kubernetes API server starting in Kubernetes v1.22. The admission controller evaluates pods against the specified policy level during creation or update operations."}),"\n",(0,i.jsx)(s.h3,{id:"enforcement-modes",children:"Enforcement Modes"}),"\n",(0,i.jsx)(s.p,{children:"PSS supports three enforcement modes that can be applied independently to each namespace:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"enforce"}),": Violating pods are rejected and cannot be created",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"audit"}),": Violations are logged to the audit log but pods are still created",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"warn"}),": Violations trigger a warning message to the user but pods are still created"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Multiple modes can be applied simultaneously to the same namespace for layered enforcement and visibility."}),"\n",(0,i.jsx)(s.h3,{id:"example-apply-restricted-policy-to-a-namespace",children:"Example: Apply Restricted Policy to a Namespace"}),"\n",(0,i.jsx)(s.p,{children:"Apply the restricted profile with enforcement and warnings:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Namespace\nmetadata:\n  name: production-apps\n  labels:\n    pod-security.kubernetes.io/enforce: "restricted"\n    pod-security.kubernetes.io/enforce-version: "v1.34"\n    pod-security.kubernetes.io/audit: "restricted"\n    pod-security.kubernetes.io/audit-version: "v1.34"\n    pod-security.kubernetes.io/warn: "restricted"\n    pod-security.kubernetes.io/warn-version: "v1.34"\n'})}),"\n",(0,i.jsx)(s.p,{children:"Apply the baseline profile for development workloads:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Namespace\nmetadata:\n  name: dev-apps\n  labels:\n    pod-security.kubernetes.io/enforce: "baseline"\n    pod-security.kubernetes.io/enforce-version: "v1.34"\n    pod-security.kubernetes.io/warn: "restricted"\n    pod-security.kubernetes.io/warn-version: "v1.34"\n'})}),"\n",(0,i.jsx)(s.h3,{id:"cluster-wide-default-policy",children:"Cluster-Wide Default Policy"}),"\n",(0,i.jsx)(s.p,{children:"Configure cluster-wide Pod Security Standards by setting admission configuration in the API server:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-yaml",children:'apiVersion: apiserver.config.k8s.io/v1\nkind: AdmissionConfiguration\nplugins:\n  - name: PodSecurity\n    configuration:\n      apiVersion: pod-security.admission.config.k8s.io/v1\n      kind: PodSecurityConfiguration\n      defaults:\n        enforce: "baseline"\n        enforce-version: "v1.34"\n        audit: "restricted"\n        audit-version: "v1.34"\n        warn: "restricted"\n        warn-version: "v1.34"\n      exemptions:\n        usernames: []\n        runtimeClasses: []\n        namespaces: ["kube-system"]\n'})}),"\n",(0,i.jsxs)(s.p,{children:["For more details on enforcing security at the namespace level, see ",(0,i.jsx)(s.a,{href:"/docs/fundamentals/authorization/rbac",children:"Kubernetes Namespace Security"}),"."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"best-practices-for-pod-security-standards",children:"Best Practices for Pod Security Standards"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:'Use "restricted" policies'})," in ",(0,i.jsx)(s.strong,{children:"production namespaces"})," to enforce strong security."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:'Apply "baseline" policies'})," for ",(0,i.jsx)(s.strong,{children:"development and testing"})," environments."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:'Avoid the "privileged" level'})," unless absolutely necessary."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Combine PSS with Role-Based Access Control (RBAC)"})," for ",(0,i.jsx)(s.strong,{children:"granular access control"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["For securing authentication and authorization in Kubernetes, refer to ",(0,i.jsx)(s.a,{href:"/docs/fundamentals/authorization/rbac",children:"Role-Based Access Control (RBAC)"}),"."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Pod Security Standards (PSS)"})," enforce security at the ",(0,i.jsx)(s.strong,{children:"namespace level"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["The ",(0,i.jsx)(s.strong,{children:"restricted"})," level offers ",(0,i.jsx)(s.strong,{children:"maximum protection"})," against ",(0,i.jsx)(s.strong,{children:"privilege escalation"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["Kubernetes ",(0,i.jsx)(s.strong,{children:"deprecated Pod Security Policies (PSP)"})," in favor of ",(0,i.jsx)(s.strong,{children:"PSS enforcement"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Applying the right PSS level"})," helps prevent ",(0,i.jsx)(s.strong,{children:"security misconfigurations"})," and ",(0,i.jsx)(s.strong,{children:"workload vulnerabilities"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["For more on securing workloads in Kubernetes, refer to ",(0,i.jsx)(s.a,{href:"/docs/best_practices/cluster_setup_and_hardening/pod_security/pod_security_standards",children:"Pod Security Standards"}),"."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"references",children:"References"}),"\n",(0,i.jsx)(s.p,{children:"This article is based on information from the following official sources:"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.a,{href:"https://kubernetes.io/docs/concepts/security/pod-security-standards/",children:"Pod Security Standards"})," - Kubernetes Documentation"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.a,{href:"https://kubernetes.io/docs/concepts/security/pod-security-admission/",children:"Pod Security Admission"})," - Kubernetes Documentation"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.a,{href:"https://kubernetes.io/docs/tasks/configure-pod-container/enforce-standards-namespace-labels/",children:"Enforce Pod Security Standards with Namespace Labels"})," - Kubernetes Documentation"]}),"\n"]})]})}function p(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453(e,s,n){n.d(s,{R:()=>c,x:()=>o});var r=n(6540);const i={},t=r.createContext(i);function c(e){const s=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(t.Provider,{value:s},e.children)}}}]);