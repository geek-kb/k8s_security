"use strict";(self.webpackChunkk_8_s_security=self.webpackChunkk_8_s_security||[]).push([[5218],{6089:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>d,frontMatter:()=>c,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"best_practices/cluster_setup_and_hardening/kubelet_security","title":"Kubelet Security","description":"Learn best practices for securing the Kubernetes Kubelet to maintain cluster integrity and prevent security risks.","source":"@site/docs/best_practices/cluster_setup_and_hardening/kubelet_security.md","sourceDirName":"best_practices/cluster_setup_and_hardening","slug":"/best_practices/cluster_setup_and_hardening/kubelet_security","permalink":"/k8s_security/docs/best_practices/cluster_setup_and_hardening/kubelet_security","draft":false,"unlisted":false,"editUrl":"https://github.com/geek-kb/k8s_security/edit/main/docs/best_practices/cluster_setup_and_hardening/kubelet_security.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Kubelet Security","description":"Learn best practices for securing the Kubernetes Kubelet to maintain cluster integrity and prevent security risks."},"sidebar":"guidesSidebar","previous":{"title":"Kube-Bench: Kubernetes CIS Benchmarking Tool","permalink":"/k8s_security/docs/best_practices/cluster_setup_and_hardening/cis_benchmark_kube_bench"},"next":{"title":"Network Policies","permalink":"/k8s_security/docs/best_practices/cluster_setup_and_hardening/network_security/network_policies"}}');var r=s(4848),i=s(8453);const c={sidebar_position:3,title:"Kubelet Security",description:"Learn best practices for securing the Kubernetes Kubelet to maintain cluster integrity and prevent security risks."},l="Kubelet Security",a={},o=[{value:"Why Kubelet Security Matters",id:"why-kubelet-security-matters",level:2},{value:"Kubelet Security Best Practices",id:"kubelet-security-best-practices",level:2},{value:"1. Secure Kubelet Communication",id:"1-secure-kubelet-communication",level:3},{value:"2. Enable Authentication and Authorization",id:"2-enable-authentication-and-authorization",level:3},{value:"3. Disable Anonymous Access",id:"3-disable-anonymous-access",level:3},{value:"4. Restrict Kubelet API Access",id:"4-restrict-kubelet-api-access",level:3},{value:"5. Enforce Pod Security Standards",id:"5-enforce-pod-security-standards",level:3},{value:"6. Limit Kubelet Permissions",id:"6-limit-kubelet-permissions",level:3},{value:"7. Regularly Update and Patch the Kubelet",id:"7-regularly-update-and-patch-the-kubelet",level:3},{value:"Additional Security Features",id:"additional-security-features",level:2},{value:"1. Pod Security Admission (PSA)",id:"1-pod-security-admission-psa",level:3},{value:"2. Enable Kubelet Audit Logs",id:"2-enable-kubelet-audit-logs",level:3},{value:"3. Limit Resource Consumption",id:"3-limit-resource-consumption",level:3},{value:"Key Takeaways",id:"key-takeaways",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"kubelet-security",children:"Kubelet Security"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"Kubelet"})," is a critical component of a ",(0,r.jsx)(n.strong,{children:"Kubernetes node"}),", responsible for managing containers and ensuring that the desired ",(0,r.jsx)(n.strong,{children:"containers"})," are running. Due to its powerful control over ",(0,r.jsx)(n.strong,{children:"containers"}),", securing the ",(0,r.jsx)(n.strong,{children:"Kubelet"})," is paramount to maintaining the overall security of the ",(0,r.jsx)(n.strong,{children:"Kubernetes cluster"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"why-kubelet-security-matters",children:"Why Kubelet Security Matters"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Node Compromise Risk:"})," The Kubelet has direct access to ",(0,r.jsx)(n.strong,{children:"container runtimes"}),", posing a potential risk if not properly secured."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cluster-wide Impact:"})," A compromised Kubelet can lead to unauthorized access to ",(0,r.jsx)(n.strong,{children:"pods"}),", ",(0,r.jsx)(n.strong,{children:"secrets"}),", and other cluster resources."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"API Access Control:"})," Kubelets have access to the ",(0,r.jsx)(n.strong,{children:"Kubernetes API"}),", and improper configurations could lead to an ",(0,r.jsx)(n.strong,{children:"elevated attack surface"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"kubelet-security-best-practices",children:"Kubelet Security Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"1-secure-kubelet-communication",children:"1. Secure Kubelet Communication"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Issue:"})," Unencrypted communication to and from the Kubelet can lead to data exposure.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.strong,{children:"Fix:"})," Ensure all communications are ",(0,r.jsx)(n.strong,{children:"encrypted"})," using ",(0,r.jsx)(n.strong,{children:"TLS certificates"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# Example Kubelet TLS Configuration\n--tls-cert-file=/var/lib/kubelet/pki/kubelet.crt\n--tls-private-key-file=/var/lib/kubelet/pki/kubelet.key\n--client-ca-file=/var/lib/kubernetes/pki/ca.crt\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-enable-authentication-and-authorization",children:"2. Enable Authentication and Authorization"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Issue:"})," Unauthenticated and unauthorized access to the Kubelet API can lead to cluster compromise.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.strong,{children:"Fix:"})," Require ",(0,r.jsx)(n.strong,{children:"client certificates"})," and enable ",(0,r.jsx)(n.strong,{children:"Webhook Authorization"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# Kubelet Authentication and Authorization\n--authorization-mode=Webhook\n--authentication-token-webhook=true\n--client-ca-file=/var/lib/kubernetes/pki/ca.crt\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-disable-anonymous-access",children:"3. Disable Anonymous Access"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Issue:"})," Allowing anonymous access can lead to unauthorized API calls.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.strong,{children:"Fix:"})," Prevent unauthorized users from accessing the ",(0,r.jsx)(n.strong,{children:"Kubelet API"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"--anonymous-auth=false\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-restrict-kubelet-api-access",children:"4. Restrict Kubelet API Access"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Issue:"})," Exposing the Kubelet API to external networks increases the risk of attacks.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.strong,{children:"Fix:"})," Limit the ",(0,r.jsx)(n.strong,{children:"Kubelet API"})," exposure to ",(0,r.jsx)(n.strong,{children:"localhost"})," or the ",(0,r.jsx)(n.strong,{children:"internal network"})," only."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"--address=127.0.0.1\n--read-only-port=0\n"})}),"\n",(0,r.jsx)(n.h3,{id:"5-enforce-pod-security-standards",children:"5. Enforce Pod Security Standards"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Issue:"})," Insecure pod configurations can lead to privilege escalation.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.strong,{children:"Fix:"})," Use ",(0,r.jsx)(n.strong,{children:"Pod Security Policies (PSP)"})," or ",(0,r.jsx)(n.strong,{children:"Pod Security Admission"})," to restrict ",(0,r.jsx)(n.strong,{children:"privileged containers"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# Example Pod Security Policy\napiVersion: policy/v1beta1\nkind: PodSecurityPolicy\nmetadata:\n  name: restricted-psp\nspec:\n  privileged: false\n  volumes:\n    - "configMap"\n    - "emptyDir"\n  runAsUser:\n    rule: "MustRunAsNonRoot"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"6-limit-kubelet-permissions",children:"6. Limit Kubelet Permissions"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Issue:"})," Excessive permissions can lead to unauthorized actions within the cluster.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.strong,{children:"Fix:"})," Apply ",(0,r.jsx)(n.strong,{children:"Role-Based Access Control (RBAC)"})," to limit Kubelet API permissions."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# Example RBAC for Kubelet\nkind: ClusterRole\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: kubelet-read-only\nrules:\n  - apiGroups: [""]\n    resources: ["pods", "nodes"]\n    verbs: ["get", "list"]\n'})}),"\n",(0,r.jsx)(n.h3,{id:"7-regularly-update-and-patch-the-kubelet",children:"7. Regularly Update and Patch the Kubelet"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Issue:"})," Outdated Kubelet versions may contain known vulnerabilities.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.strong,{children:"Fix:"})," Keep the ",(0,r.jsx)(n.strong,{children:"Kubelet"})," updated and apply ",(0,r.jsx)(n.strong,{children:"security patches"})," promptly."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"additional-security-features",children:"Additional Security Features"}),"\n",(0,r.jsx)(n.h3,{id:"1-pod-security-admission-psa",children:"1. Pod Security Admission (PSA)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Issue:"})," Deprecated ",(0,r.jsx)(n.strong,{children:"Pod Security Policies (PSP)"})," need modern alternatives.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.strong,{children:"Fix:"})," Use ",(0,r.jsx)(n.strong,{children:"Pod Security Admission"})," to enforce security standards."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# Example PSA Configuration\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: restricted\n  labels:\n    pod-security.kubernetes.io/enforce: "restricted"\n    pod-security.kubernetes.io/audit: "restricted"\n    pod-security.kubernetes.io/warn: "restricted"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"2-enable-kubelet-audit-logs",children:"2. Enable Kubelet Audit Logs"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Issue:"})," Lack of auditing makes it difficult to track API requests and detect anomalies.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.strong,{children:"Fix:"})," Enable ",(0,r.jsx)(n.strong,{children:"Kubelet auditing"})," to monitor activities."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"--audit-log-path=/var/log/kubelet-audit.log\n--audit-policy-file=/etc/kubernetes/audit-policy.yaml\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-limit-resource-consumption",children:"3. Limit Resource Consumption"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Issue:"})," Unrestricted resource usage can lead to resource exhaustion attacks.",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.strong,{children:"Fix:"})," Set ",(0,r.jsx)(n.strong,{children:"resource limits"})," on the ",(0,r.jsx)(n.strong,{children:"Kubelet"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"--kube-reserved=cpu=200m,memory=512Mi,ephemeral-storage=1Gi\n--system-reserved=cpu=100m,memory=256Mi,ephemeral-storage=1Gi\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Securing the ",(0,r.jsx)(n.strong,{children:"Kubelet"})," is crucial for maintaining the ",(0,r.jsx)(n.strong,{children:"integrity"})," and ",(0,r.jsx)(n.strong,{children:"security"})," of the ",(0,r.jsx)(n.strong,{children:"Kubernetes cluster"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Follow ",(0,r.jsx)(n.strong,{children:"best practices"})," by enabling ",(0,r.jsx)(n.strong,{children:"authentication"}),", ",(0,r.jsx)(n.strong,{children:"authorization"}),", and ",(0,r.jsx)(n.strong,{children:"audit logs"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Regularly ",(0,r.jsx)(n.strong,{children:"update"})," and ",(0,r.jsx)(n.strong,{children:"monitor"})," the ",(0,r.jsx)(n.strong,{children:"Kubelet"})," to prevent ",(0,r.jsx)(n.strong,{children:"exploitation"})," of known vulnerabilities."]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>l});var t=s(6540);const r={},i=t.createContext(r);function c(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);