"use strict";(globalThis.webpackChunkk_8_s_security=globalThis.webpackChunkk_8_s_security||[]).push([[4165],{4177(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>c,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"best-practices/cluster-setup-and-hardening/rbac-and-identity/kubectl-bindrole","title":"kubectl-bindrole","description":"kubectl-bindrole finds all Kubernetes roles and cluster roles bound to a specified ServiceAccount, User, or Group, helping audit RBAC configurations.","source":"@site/docs/best-practices/cluster-setup-and-hardening/rbac-and-identity/kubectl-bindrole.md","sourceDirName":"best-practices/cluster-setup-and-hardening/rbac-and-identity","slug":"/best-practices/cluster-setup-and-hardening/rbac-and-identity/kubectl-bindrole","permalink":"/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/kubectl-bindrole","draft":false,"unlisted":false,"editUrl":"https://github.com/geek-kb/k8s_security/edit/main/docs/best-practices/cluster-setup-and-hardening/rbac-and-identity/kubectl-bindrole.md","tags":[{"inline":true,"label":"tool","permalink":"/kubernetes-security/tags/tool"},{"inline":true,"label":"rbac","permalink":"/kubernetes-security/tags/rbac"},{"inline":true,"label":"authorization","permalink":"/kubernetes-security/tags/authorization"},{"inline":true,"label":"CKS","permalink":"/kubernetes-security/tags/cks"}],"version":"current","lastUpdatedBy":"Itai Ganot","lastUpdatedAt":1771236448000,"sidebarPosition":18,"frontMatter":{"sidebar_position":18,"title":"kubectl-bindrole","description":"kubectl-bindrole finds all Kubernetes roles and cluster roles bound to a specified ServiceAccount, User, or Group, helping audit RBAC configurations.","keywords":["kubernetes security tool","kubectl-bindrole","RBAC audit","role binding","kubernetes authorization","access control","service account permissions","security audit","CKS"],"tags":["tool","rbac","authorization","CKS"],"related":["/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/insecure-rbac-permissions-mitigation/","/kubernetes-security/fundamentals/authorization/rbac/","/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/kubectl-who-can/"]},"sidebar":"default","previous":{"title":"rback","permalink":"/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/rback"},"next":{"title":"kubernetes-rbac-audit","permalink":"/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/kubernetes-rbac-audit"}}');var t=s(4848),r=s(8453);const c={sidebar_position:18,title:"kubectl-bindrole",description:"kubectl-bindrole finds all Kubernetes roles and cluster roles bound to a specified ServiceAccount, User, or Group, helping audit RBAC configurations.",keywords:["kubernetes security tool","kubectl-bindrole","RBAC audit","role binding","kubernetes authorization","access control","service account permissions","security audit","CKS"],tags:["tool","rbac","authorization","CKS"],related:["/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/insecure-rbac-permissions-mitigation/","/kubernetes-security/fundamentals/authorization/rbac/","/kubernetes-security/best-practices/cluster-setup-and-hardening/rbac-and-identity/kubectl-who-can/"]},l="kubectl-bindrole",a={},o=[{value:"Use Cases",id:"use-cases",level:2},{value:"Installation",id:"installation",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Find Roles for a ServiceAccount",id:"find-roles-for-a-serviceaccount",level:3},{value:"Find Roles for a User",id:"find-roles-for-a-user",level:3},{value:"Find Roles for a Group",id:"find-roles-for-a-group",level:3},{value:"Show Role Details",id:"show-role-details",level:3},{value:"Output as JSON",id:"output-as-json",level:3},{value:"Output as YAML",id:"output-as-yaml",level:3},{value:"Understanding the Output",id:"understanding-the-output",level:2},{value:"Common Audit Scenarios",id:"common-audit-scenarios",level:2},{value:"Audit Default Service Accounts",id:"audit-default-service-accounts",level:3},{value:"Check for Cluster-Admin Bindings",id:"check-for-cluster-admin-bindings",level:3},{value:"Compare Permissions Across Environments",id:"compare-permissions-across-environments",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"kubectl-bindrole",children:"kubectl-bindrole"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"kubectl-bindrole"}),' is a kubectl plugin that finds all Roles and ClusterRoles bound to a specified ServiceAccount, User, or Group. It provides a quick way to answer "What roles does this subject have?" without manually searching through all RoleBindings and ClusterRoleBindings.']}),"\n",(0,t.jsx)(n.p,{children:'This tool complements kubectl-who-can by providing the inverse lookup: instead of "who can do X?", it answers "what can subject Y do?"'}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Audit all roles assigned to a specific service account."}),"\n",(0,t.jsx)(n.li,{children:"Investigate permissions granted to a user or group."}),"\n",(0,t.jsx)(n.li,{children:"Review role bindings during security assessments."}),"\n",(0,t.jsx)(n.li,{children:"Debug authorization issues by listing all effective roles."}),"\n",(0,t.jsx)(n.li,{children:"Document permissions for compliance requirements."}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.p,{children:"Install kubectl-bindrole using krew (the kubectl plugin manager):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl krew install bindrole\n"})}),"\n",(0,t.jsx)(n.p,{children:"Or download directly from GitHub:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -LO https://github.com/Ladicle/kubectl-bindrole/releases/download/v1.0.0/kubectl-bindrole_linux_amd64.tar.gz\ntar xzf kubectl-bindrole_linux_amd64.tar.gz\nchmod +x kubectl-bindrole\nsudo mv kubectl-bindrole /usr/local/bin/\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,t.jsx)(n.h3,{id:"find-roles-for-a-serviceaccount",children:"Find Roles for a ServiceAccount"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl bindrole serviceaccount my-namespace:my-service-account\n"})}),"\n",(0,t.jsx)(n.p,{children:"Example output:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ROLE                    BINDING                  SCOPE\nread-pods               pod-reader-binding       Namespace: my-namespace\nconfigmap-admin         cm-admin-binding         Namespace: my-namespace\ncluster-viewer          cluster-view-binding     Cluster\n"})}),"\n",(0,t.jsx)(n.h3,{id:"find-roles-for-a-user",children:"Find Roles for a User"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl bindrole user jane@example.com\n"})}),"\n",(0,t.jsx)(n.h3,{id:"find-roles-for-a-group",children:"Find Roles for a Group"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl bindrole group developers\n"})}),"\n",(0,t.jsx)(n.h3,{id:"show-role-details",children:"Show Role Details"}),"\n",(0,t.jsxs)(n.p,{children:["Add ",(0,t.jsx)(n.code,{children:"-o wide"})," to see the rules in each role:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl bindrole serviceaccount my-namespace:my-sa -o wide\n"})}),"\n",(0,t.jsx)(n.p,{children:"Example output:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ROLE             BINDING              SCOPE                 RULES\nread-pods        pod-reader-binding   Namespace: default    pods: [get list watch]\nsecret-reader    secret-binding       Namespace: default    secrets: [get list]\ncluster-viewer   view-binding         Cluster               *: [get list watch]\n"})}),"\n",(0,t.jsx)(n.h3,{id:"output-as-json",children:"Output as JSON"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl bindrole serviceaccount my-namespace:my-sa -o json\n"})}),"\n",(0,t.jsx)(n.h3,{id:"output-as-yaml",children:"Output as YAML"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl bindrole serviceaccount my-namespace:my-sa -o yaml\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"understanding-the-output",children:"Understanding the Output"}),"\n",(0,t.jsx)(n.p,{children:"The output displays:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Column"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"ROLE"}),(0,t.jsx)(n.td,{children:"Name of the Role or ClusterRole"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"BINDING"}),(0,t.jsx)(n.td,{children:"Name of the RoleBinding or ClusterRoleBinding"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"SCOPE"}),(0,t.jsx)(n.td,{children:'Namespace scope or "Cluster" for cluster-wide roles'})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"RULES"}),(0,t.jsx)(n.td,{children:"(Wide mode) API groups, resources, and verbs granted"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"common-audit-scenarios",children:"Common Audit Scenarios"}),"\n",(0,t.jsx)(n.h3,{id:"audit-default-service-accounts",children:"Audit Default Service Accounts"}),"\n",(0,t.jsx)(n.p,{children:"Check what roles are bound to default service accounts:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'for ns in $(kubectl get ns -o jsonpath=\'{.items[*].metadata.name}\'); do\n  echo "=== Namespace: $ns ==="\n  kubectl bindrole serviceaccount $ns:default 2>/dev/null || echo "No bindings found"\ndone\n'})}),"\n",(0,t.jsx)(n.h3,{id:"check-for-cluster-admin-bindings",children:"Check for Cluster-Admin Bindings"}),"\n",(0,t.jsx)(n.p,{children:"Identify service accounts with cluster-admin privileges:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'kubectl get clusterrolebindings -o json | \\\n  jq -r \'.items[] | select(.roleRef.name == "cluster-admin") | .subjects[]? | "\\(.kind): \\(.namespace)/\\(.name)"\'\n'})}),"\n",(0,t.jsx)(n.h3,{id:"compare-permissions-across-environments",children:"Compare Permissions Across Environments"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Development SA\nkubectl bindrole serviceaccount development:app-sa -o wide\n\n# Production SA\nkubectl bindrole serviceaccount production:app-sa -o wide\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Regular audits:"})," Run bindrole checks for all service accounts in production namespaces."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Document expected roles:"})," Maintain documentation of which roles should be bound to which subjects."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Alert on changes:"})," Compare bindrole output over time to detect unexpected role assignments."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Check default SAs:"})," Ensure default service accounts in namespaces have minimal or no role bindings."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Combine with other tools:"})," Use with rakkess and kubectl-who-can for comprehensive RBAC analysis."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsx)(n.p,{children:"This article is based on information from the following official sources:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://github.com/Ladicle/kubectl-bindrole",children:"kubectl-bindrole GitHub Repository"})," - GitHub"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/access-authn-authz/rbac/",children:"Using RBAC Authorization"})," - Kubernetes Documentation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/extend-kubectl/kubectl-plugins/",children:"Extend kubectl with plugins"})," - Kubernetes Documentation"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>c,x:()=>l});var i=s(6540);const t={},r=i.createContext(t);function c(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);