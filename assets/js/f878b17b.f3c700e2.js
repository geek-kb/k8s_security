"use strict";(self.webpackChunkk_8_s_security=self.webpackChunkk_8_s_security||[]).push([[2416],{4821:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>c,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"best_practices/monitoring_logging_and_runtime_security/tracee","title":"Tracee","description":"Tracee is a runtime security and forensics tool that uses eBPF to detect suspicious activity in Linux systems, including Kubernetes environments.","source":"@site/docs/best_practices/monitoring_logging_and_runtime_security/tracee.md","sourceDirName":"best_practices/monitoring_logging_and_runtime_security","slug":"/best_practices/monitoring_logging_and_runtime_security/tracee","permalink":"/docs/best_practices/monitoring_logging_and_runtime_security/tracee","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"Itai Ganot","lastUpdatedAt":1742842158000,"sidebarPosition":8,"frontMatter":{"title":"Tracee","description":"Tracee is a runtime security and forensics tool that uses eBPF to detect suspicious activity in Linux systems, including Kubernetes environments.","sidebar_position":8}}');var i=n(4848),r=n(8453);const c={title:"Tracee",description:"Tracee is a runtime security and forensics tool that uses eBPF to detect suspicious activity in Linux systems, including Kubernetes environments.",sidebar_position:8},a="Tracee",l={},o=[{value:"Usage",id:"usage",level:2},{value:"1. Install Tracee with Docker",id:"1-install-tracee-with-docker",level:3},{value:"2. Run Tracee with Detection Rules",id:"2-run-tracee-with-detection-rules",level:3},{value:"3. Output Events to JSON",id:"3-output-events-to-json",level:3},{value:"4. Filter Specific Events",id:"4-filter-specific-events",level:3},{value:"5. Use with Tracee-Ebpf and Tracee-Rules",id:"5-use-with-tracee-ebpf-and-tracee-rules",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Resources",id:"resources",level:2}];function d(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"tracee",children:"Tracee"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Required knowledge for the CKS certification."})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Tracee"})," is an open-source ",(0,i.jsx)(s.strong,{children:"runtime security"})," and ",(0,i.jsx)(s.strong,{children:"digital forensics"})," tool developed by ",(0,i.jsx)(s.strong,{children:"Aqua Security"}),". It leverages ",(0,i.jsx)(s.strong,{children:"eBPF (extended Berkeley Packet Filter)"})," to observe kernel-level events and detect suspicious behavior in ",(0,i.jsx)(s.strong,{children:"containerized"})," and ",(0,i.jsx)(s.strong,{children:"Kubernetes"})," environments."]}),"\n",(0,i.jsxs)(s.p,{children:["Tracee helps identify ",(0,i.jsx)(s.strong,{children:"anomalous activity"}),", such as privilege escalations, process injections, and unexpected syscalls, by applying predefined or custom ",(0,i.jsx)(s.strong,{children:"security detection rules"}),"."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(s.h3,{id:"1-install-tracee-with-docker",children:"1. Install Tracee with Docker"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"docker run --rm --privileged -v /etc/os-release:/etc/os-release:ro \\\n  -v /usr/src:/usr/src:ro -v /lib/modules:/lib/modules:ro \\\n  -v /tmp/tracee:/tmp/tracee aquasec/tracee:latest\n"})}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsx)(s.p,{children:"This runs Tracee in a privileged container with required access to the host's kernel interfaces."}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"2-run-tracee-with-detection-rules",children:"2. Run Tracee with Detection Rules"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"tracee --detect\n"})}),"\n",(0,i.jsxs)(s.p,{children:["This activates Tracee's ",(0,i.jsx)(s.strong,{children:"signature-based detection engine"}),", which triggers alerts on behaviors like:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Loading kernel modules"}),"\n",(0,i.jsx)(s.li,{children:"Creating raw sockets"}),"\n",(0,i.jsx)(s.li,{children:"Executing code in memory (shellcode)"}),"\n",(0,i.jsxs)(s.li,{children:["Using ",(0,i.jsx)(s.code,{children:"ptrace"})," to inspect or control processes"]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"3-output-events-to-json",children:"3. Output Events to JSON"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"tracee --output json\n"})}),"\n",(0,i.jsx)(s.p,{children:"You can consume this output via logging systems or SIEM tools for real-time analysis."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"4-filter-specific-events",children:"4. Filter Specific Events"}),"\n",(0,i.jsx)(s.p,{children:"Tracee allows filtering by process name, UID, syscall, or container ID:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"tracee --trace comm=sh,uid=1000\n"})}),"\n",(0,i.jsx)(s.p,{children:"Only tracks shell processes by a specific user."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"5-use-with-tracee-ebpf-and-tracee-rules",children:"5. Use with Tracee-Ebpf and Tracee-Rules"}),"\n",(0,i.jsx)(s.p,{children:"You can run Tracee as two components:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"tracee-ebpf"}),": Captures system events"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"tracee-rules"}),": Applies detection logic"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Example:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"tracee-ebpf | tracee-rules\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Run Tracee on ",(0,i.jsx)(s.strong,{children:"production nodes"})," in ",(0,i.jsx)(s.strong,{children:"monitoring mode"})," to observe runtime behavior and detect anomalies."]}),"\n",(0,i.jsxs)(s.li,{children:["Use ",(0,i.jsx)(s.strong,{children:"detection rules"})," aligned with known Kubernetes attack vectors (e.g., privilege escalation, container escape)."]}),"\n",(0,i.jsxs)(s.li,{children:["Integrate with tools like ",(0,i.jsx)(s.strong,{children:"Falco"})," or ",(0,i.jsx)(s.strong,{children:"Tetragon"})," for broader runtime visibility."]}),"\n",(0,i.jsx)(s.li,{children:"Ship logs to centralized systems (e.g., Elasticsearch, Loki) for analysis."}),"\n",(0,i.jsx)(s.li,{children:"Continuously tune rules to reduce false positives and focus on high-impact detections."}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"resources",children:"Resources"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"GitHub:"})," ",(0,i.jsx)(s.a,{href:"https://github.com/aquasecurity/tracee",children:"https://github.com/aquasecurity/tracee"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Official Documentation:"})," ",(0,i.jsx)(s.a,{href:"https://aquasecurity.github.io/tracee",children:"https://aquasecurity.github.io/tracee"})]}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>c,x:()=>a});var t=n(6540);const i={},r=t.createContext(i);function c(e){const s=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);