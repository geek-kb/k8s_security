"use strict";(self.webpackChunkk_8_s_security=self.webpackChunkk_8_s_security||[]).push([[3614],{4711:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"attack_vectors/compromised_api_server","title":"Compromised API Server","description":"Exploiting Kubernetes API server vulnerabilities and how attackers gain unauthorized access.","source":"@site/docs/attack_vectors/compromised_api_server.md","sourceDirName":"attack_vectors","slug":"/attack_vectors/compromised_api_server","permalink":"/k8s_security/docs/attack_vectors/compromised_api_server","draft":false,"unlisted":false,"editUrl":"https://github.com/geek-kb/k8s_security/edit/main/docs/attack_vectors/compromised_api_server.md","tags":[],"version":"current","lastUpdatedBy":"Itai Ganot","lastUpdatedAt":1742801266000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Compromised API Server","description":"Exploiting Kubernetes API server vulnerabilities and how attackers gain unauthorized access."},"sidebar":"default","previous":{"title":"Section Introduction","permalink":"/k8s_security/docs/attack_vectors/intro"},"next":{"title":"Exposed Kubernetes Dashboard","permalink":"/k8s_security/docs/attack_vectors/exposed_dashboard"}}');var i=s(4848),n=s(8453);const a={sidebar_position:2,title:"Compromised API Server",description:"Exploiting Kubernetes API server vulnerabilities and how attackers gain unauthorized access."},o="Compromised API Server",c={},l=[{value:"Exploitation Steps: Exposed API Endpoints",id:"exploitation-steps-exposed-api-endpoints",level:2},{value:"1. Scan for an Exposed API Server",id:"1-scan-for-an-exposed-api-server",level:3},{value:"2. Access the API Server Without Authentication",id:"2-access-the-api-server-without-authentication",level:3},{value:"3. Delete Cluster Resources",id:"3-delete-cluster-resources",level:3},{value:"4. Escalate Privileges",id:"4-escalate-privileges",level:3},{value:"Result",id:"result",level:3},{value:"Mitigation",id:"mitigation",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"compromised-api-server",children:"Compromised API Server"})}),"\n",(0,i.jsx)(t.p,{children:"A compromised Kubernetes API server allows attackers to interact directly with the cluster\u2019s control plane. If authentication or authorization is misconfigured\u2014or worse, disabled entirely\u2014an attacker may gain full control over workloads, resources, and data."}),"\n",(0,i.jsx)(t.p,{children:"This article demonstrates how attackers identify exposed API servers and exploit them to disrupt services or escalate privileges."}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"exploitation-steps-exposed-api-endpoints",children:"Exploitation Steps: Exposed API Endpoints"}),"\n",(0,i.jsx)(t.h3,{id:"1-scan-for-an-exposed-api-server",children:"1. Scan for an Exposed API Server"}),"\n",(0,i.jsx)(t.p,{children:"An attacker performs a port scan to discover the Kubernetes API server:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"nmap -p 6443 <cluster-ip>\n"})}),"\n",(0,i.jsx)(t.p,{children:"Port 6443 is the default Kubernetes API server port. If reachable from outside the cluster, it may be vulnerable."}),"\n",(0,i.jsx)(t.h3,{id:"2-access-the-api-server-without-authentication",children:"2. Access the API Server Without Authentication"}),"\n",(0,i.jsx)(t.p,{children:"The attacker sends an unauthenticated request to list pods:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"curl -k https://<api-server-ip>:6443/api/v1/pods\n"})}),"\n",(0,i.jsx)(t.p,{children:"If authentication is misconfigured or disabled, the server may return a list of all pods in the cluster."}),"\n",(0,i.jsx)(t.h3,{id:"3-delete-cluster-resources",children:"3. Delete Cluster Resources"}),"\n",(0,i.jsx)(t.p,{children:"The attacker attempts to delete a critical pod:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"curl -k -X DELETE https://<api-server-ip>:6443/api/v1/namespaces/default/pods/victim-pod\n"})}),"\n",(0,i.jsx)(t.p,{children:"Without proper access controls, the request may succeed, resulting in service downtime or disruption."}),"\n",(0,i.jsx)(t.h3,{id:"4-escalate-privileges",children:"4. Escalate Privileges"}),"\n",(0,i.jsx)(t.p,{children:"After gaining API access, the attacker attempts to retrieve service account tokens or secrets:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"curl -k https://<api-server-ip>:6443/api/v1/secrets\n"})}),"\n",(0,i.jsx)(t.p,{children:"They may exploit these credentials to impersonate other services or users, bypass RBAC policies, and further compromise the cluster."}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h3,{id:"result",children:"Result"}),"\n",(0,i.jsx)(t.p,{children:"An attacker with access to a misconfigured API server can:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"View, modify, or delete workloads and configurations."}),"\n",(0,i.jsx)(t.li,{children:"Exfiltrate secrets and service account tokens."}),"\n",(0,i.jsx)(t.li,{children:"Deploy malicious containers or alter existing ones."}),"\n",(0,i.jsx)(t.li,{children:"Escalate privileges and compromise other components."}),"\n",(0,i.jsx)(t.li,{children:"Fully control or destroy the Kubernetes cluster."}),"\n"]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"mitigation",children:"Mitigation"}),"\n",(0,i.jsxs)(t.p,{children:["\u27a1 ",(0,i.jsx)(t.a,{href:"/docs/best_practices/cluster_setup_and_hardening/api_server_security/compromised_api_server_mitigation",children:"Securing the Kubernetes API Server"})]})]})}function p(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>o});var r=s(6540);const i={},n=r.createContext(i);function a(e){const t=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(n.Provider,{value:t},e.children)}}}]);