"use strict";(globalThis.webpackChunkk_8_s_security=globalThis.webpackChunkk_8_s_security||[]).push([[7471],{8453(e,n,t){t.d(n,{R:()=>a,x:()=>o});var s=t(6540);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}},9652(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"best-practices/monitoring-logging-and-runtime-security/falco","title":"Falco","description":"Falco is a runtime security tool for Kubernetes that detects abnormal behavior and threats based on system call monitoring and security rules.","source":"@site/docs/best-practices/monitoring-logging-and-runtime-security/falco.md","sourceDirName":"best-practices/monitoring-logging-and-runtime-security","slug":"/best-practices/monitoring-logging-and-runtime-security/falco","permalink":"/kubernetes-security/best-practices/monitoring-logging-and-runtime-security/falco","draft":false,"unlisted":false,"editUrl":"https://github.com/geek-kb/k8s_security/edit/main/docs/best-practices/monitoring-logging-and-runtime-security/falco.md","tags":[{"inline":true,"label":"tool","permalink":"/kubernetes-security/tags/tool"},{"inline":true,"label":"runtime-security","permalink":"/kubernetes-security/tags/runtime-security"},{"inline":true,"label":"detection","permalink":"/kubernetes-security/tags/detection"},{"inline":true,"label":"CKS","permalink":"/kubernetes-security/tags/cks"}],"version":"current","lastUpdatedBy":"Itai Ganot","lastUpdatedAt":1771236448000,"sidebarPosition":4,"frontMatter":{"title":"Falco","description":"Falco is a runtime security tool for Kubernetes that detects abnormal behavior and threats based on system call monitoring and security rules.","sidebar_position":4,"keywords":["kubernetes security tool","falco","runtime security","threat detection","system call monitoring","intrusion detection","CNCF","container security","security rules","CKS"],"tags":["tool","runtime-security","detection","CKS"],"related":["/kubernetes-security/best-practices/monitoring-logging-and-runtime-security/tetragon/","/kubernetes-security/best-practices/monitoring-logging-and-runtime-security/tracee/","/kubernetes-security/attack-vectors/privileged-container-escape/","/kubernetes-security/best-practices/cluster-setup-and-hardening/pod-security/seccomp-in-pods/"]},"sidebar":"default","previous":{"title":"Grype","permalink":"/kubernetes-security/best-practices/monitoring-logging-and-runtime-security/grype"},"next":{"title":"Tetragon","permalink":"/kubernetes-security/best-practices/monitoring-logging-and-runtime-security/tetragon"}}');var r=t(4848),i=t(8453);const a={title:"Falco",description:"Falco is a runtime security tool for Kubernetes that detects abnormal behavior and threats based on system call monitoring and security rules.",sidebar_position:4,keywords:["kubernetes security tool","falco","runtime security","threat detection","system call monitoring","intrusion detection","CNCF","container security","security rules","CKS"],tags:["tool","runtime-security","detection","CKS"],related:["/kubernetes-security/best-practices/monitoring-logging-and-runtime-security/tetragon/","/kubernetes-security/best-practices/monitoring-logging-and-runtime-security/tracee/","/kubernetes-security/attack-vectors/privileged-container-escape/","/kubernetes-security/best-practices/cluster-setup-and-hardening/pod-security/seccomp-in-pods/"]},o="Falco",c={},l=[{value:"Use Cases",id:"use-cases",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Run Falco as a DaemonSet in Kubernetes",id:"run-falco-as-a-daemonset-in-kubernetes",level:3},{value:"Example Rule: Alert on Shell Spawned in a Container",id:"example-rule-alert-on-shell-spawned-in-a-container",level:3},{value:"Kubernetes v1.34 Detection Rules",id:"kubernetes-v134-detection-rules",level:3},{value:"Rule: Detect Pod Resource Limit Bypass Attempts",id:"rule-detect-pod-resource-limit-bypass-attempts",level:4},{value:"Rule: Monitor Gateway API Configuration Changes",id:"rule-monitor-gateway-api-configuration-changes",level:4},{value:"Rule: Detect Suspicious Volume Snapshot Operations",id:"rule-detect-suspicious-volume-snapshot-operations",level:4},{value:"Rule: Detect eBPF Program Loading",id:"rule-detect-ebpf-program-loading",level:4},{value:"View Real-Time Events",id:"view-real-time-events",level:3},{value:"Export Events to Alerting Tools",id:"export-events-to-alerting-tools",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"References",id:"references",level:2}];function u(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"falco",children:"Falco"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Required knowledge for the CKS certification."})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Falco"})," is an open-source runtime security engine developed by the CNCF and a ",(0,r.jsx)(n.strong,{children:"required tool"})," for the CKS exam as of the ",(0,r.jsx)(n.strong,{children:"Kubernetes v1.29 curriculum update"}),". It detects unexpected or malicious behavior in Kubernetes clusters by monitoring ",(0,r.jsx)(n.strong,{children:"kernel-level system calls"})," and applying customizable security rules. Falco helps identify real-time threats such as container escapes, privilege escalations, cryptomining, and filesystem tampering."]}),"\n",(0,r.jsx)(n.p,{children:"By combining behavioral detection with Kubernetes context, Falco provides deep visibility into what's happening inside containers and nodes at runtime."}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"CKS v1.34 Update:"})," Falco now includes enhanced detection rules for Kubernetes v1.34 features, including Pod-Level Resources monitoring, Gateway API traffic analysis, and improved eBPF-based detection capabilities."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Detect container breakouts and privilege escalations"}),"\n",(0,r.jsx)(n.li,{children:"Monitor runtime behavior for policy violations"}),"\n",(0,r.jsx)(n.li,{children:"Audit workload actions like shell access or sensitive file modification"}),"\n",(0,r.jsx)(n.li,{children:"Track resource exhaustion attacks and anomalous resource consumption"}),"\n",(0,r.jsx)(n.li,{children:"Monitor Gateway API and Ingress traffic for suspicious patterns"}),"\n",(0,r.jsx)(n.li,{children:"Detect unauthorized API server access and privilege escalation attempts"}),"\n",(0,r.jsx)(n.li,{children:"Integrate with alerting and incident response systems"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,r.jsx)(n.h3,{id:"run-falco-as-a-daemonset-in-kubernetes",children:"Run Falco as a DaemonSet in Kubernetes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"helm repo add falcosecurity https://falcosecurity.github.io/charts\nhelm install falco falcosecurity/falco --namespace falco --create-namespace\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-rule-alert-on-shell-spawned-in-a-container",children:"Example Rule: Alert on Shell Spawned in a Container"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'- rule: Terminal shell in container\n  desc: A shell was spawned inside a container\n  condition: container.id != host and proc.name in (bash, sh, zsh)\n  output: "Shell spawned in container (user=%user.name command=%proc.cmdline container=%container.name namespace=%k8s.ns.name)"\n  priority: WARNING\n'})}),"\n",(0,r.jsx)(n.h3,{id:"kubernetes-v134-detection-rules",children:"Kubernetes v1.34 Detection Rules"}),"\n",(0,r.jsx)(n.h4,{id:"rule-detect-pod-resource-limit-bypass-attempts",children:"Rule: Detect Pod Resource Limit Bypass Attempts"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'- rule: Pod Resource Limit Manipulation\n  desc: Detect attempts to bypass Pod-level resource limits\n  condition: >\n    k8s_audit and\n    ka.verb in (create, update, patch) and\n    ka.target.resource = "pods" and\n    ka.req.pod.resources.limits != null and\n    (ka.req.pod.resources.limits.cpu > ka.namespace.quota.limits.cpu or\n     ka.req.pod.resources.limits.memory > ka.namespace.quota.limits.memory)\n  output: >\n    Attempt to create Pod exceeding namespace resource quota\n    (user=%ka.user.name pod=%ka.target.name namespace=%ka.target.namespace\n     requested_cpu=%ka.req.pod.resources.limits.cpu requested_memory=%ka.req.pod.resources.limits.memory)\n  priority: WARNING\n  source: k8s_audit\n'})}),"\n",(0,r.jsx)(n.h4,{id:"rule-monitor-gateway-api-configuration-changes",children:"Rule: Monitor Gateway API Configuration Changes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'- rule: Gateway API Security Configuration Change\n  desc: Detect changes to Gateway API resources that may affect security\n  condition: >\n    k8s_audit and\n    ka.verb in (create, update, patch, delete) and\n    ka.target.resource in (gateways, httproutes, tlsroutes, referencegrants) and\n    ka.target.namespace != "kube-system"\n  output: >\n    Gateway API resource modified\n    (user=%ka.user.name resource=%ka.target.resource name=%ka.target.name\n     namespace=%ka.target.namespace verb=%ka.verb)\n  priority: INFO\n  source: k8s_audit\n'})}),"\n",(0,r.jsx)(n.h4,{id:"rule-detect-suspicious-volume-snapshot-operations",children:"Rule: Detect Suspicious Volume Snapshot Operations"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'- rule: Unauthorized Volume Snapshot Access\n  desc: Detect unauthorized access to volume snapshots using Changed Block Tracking API\n  condition: >\n    k8s_audit and\n    ka.verb in (get, list, create, delete) and\n    ka.target.resource = "volumesnapshots" and\n    not ka.user.name in (backup-operator, velero, trusted-backup-users)\n  output: >\n    Suspicious volume snapshot operation\n    (user=%ka.user.name resource=%ka.target.resource name=%ka.target.name\n     namespace=%ka.target.namespace verb=%ka.verb)\n  priority: WARNING\n  source: k8s_audit\n'})}),"\n",(0,r.jsx)(n.h4,{id:"rule-detect-ebpf-program-loading",children:"Rule: Detect eBPF Program Loading"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"- rule: eBPF Program Loaded\n  desc: Detect when an eBPF program is loaded into the kernel\n  condition: >\n    evt.type = bpf and\n    evt.dir = < and\n    not container.image.repository in (falco, cilium, tetragon, tracee)\n  output: >\n    eBPF program loaded by unexpected process\n    (user=%user.name command=%proc.cmdline container=%container.name image=%container.image.repository)\n  priority: WARNING\n"})}),"\n",(0,r.jsx)(n.h3,{id:"view-real-time-events",children:"View Real-Time Events"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl logs -n falco -l app=falco\n"})}),"\n",(0,r.jsx)(n.h3,{id:"export-events-to-alerting-tools",children:"Export Events to Alerting Tools"}),"\n",(0,r.jsx)(n.p,{children:"Use Falco plugins or sidecars to forward alerts to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Slack"}),"\n",(0,r.jsx)(n.li,{children:"Prometheus"}),"\n",(0,r.jsx)(n.li,{children:"Elasticsearch"}),"\n",(0,r.jsx)(n.li,{children:"Syslog"}),"\n",(0,r.jsx)(n.li,{children:"Webhooks"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Deploy as a DaemonSet:"})," Monitor all nodes and workloads"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use tailored rulesets:"})," Tune rules based on your environment to reduce false positives"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Enable Kubernetes Audit Log integration:"})," Monitor API server activity for suspicious actions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Configure Pod-Level Resource monitoring:"})," Track resource consumption anomalies with v1.34 features"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Monitor Gateway API resources:"})," Detect unauthorized changes to traffic routing configurations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Integrate alerts into SIEM or incident response:"})," Forward alerts for real-time visibility and action"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Audit for shell access and sensitive operations:"})," Detect unexpected access to the host or critical paths"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Combine with Admission Controllers:"})," Prevent known-bad workloads at deploy-time and detect runtime issues with Falco"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use eBPF driver when available:"})," Better performance and compatibility than kernel module"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Regularly update rulesets:"})," Keep detection rules current with new Kubernetes versions and attack patterns"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Implement rule exceptions carefully:"})," Whitelist only trusted processes and containers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Monitor Falco itself:"})," Ensure the security tool is running and healthy on all nodes"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsx)(n.p,{children:"This article is based on information from the following official sources:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://falco.org/docs/",children:"Falco Documentation"})," - Falco Official Documentation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/falcosecurity/falco",children:"Falco GitHub Repository"})," - Falco Security"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/",children:"Auditing"})," - Kubernetes Documentation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://falco.org/docs/reference/rules/",children:"Falco Rules"})," - Falco Official Documentation"]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}}}]);